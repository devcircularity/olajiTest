(()=>{var e={};e.id=884,e.ids=[884],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},3721:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>d,routeModule:()=>u,tree:()=>c}),s(1691),s(596),s(7449),s(5866);var a=s(3191),r=s(8716),n=s(7922),i=s.n(n),l=s(5231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let c=["",{children:["admin",{children:["intent-config",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,1691)),"/Users/ericmwirichia/Documents/SchoolAI/admin-frontend/app/admin/intent-config/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,596)),"/Users/ericmwirichia/Documents/SchoolAI/admin-frontend/app/admin/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,7449)),"/Users/ericmwirichia/Documents/SchoolAI/admin-frontend/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/ericmwirichia/Documents/SchoolAI/admin-frontend/app/admin/intent-config/page.tsx"],m="/admin/intent-config/page",x={require:s,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/admin/intent-config/page",pathname:"/admin/intent-config",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},51:(e,t,s)=>{Promise.resolve().then(s.bind(s,4259))},4259:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>g});var a=s(326),r=s(7577),n=s(3136),i=s(912),l=s(2607),o=s(9508),c=s(4893);let d=(0,s(2881).Z)("archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);var m=s(4019),x=s(1405),u=s(3855),p=s(2978),h=s(3679);function g(){let{user:e}=(0,n.a)(),[t,s]=(0,r.useState)([]),[p,g]=(0,r.useState)(null),[f,y]=(0,r.useState)([]),[j,v]=(0,r.useState)([]),[N,k]=(0,r.useState)(!0),[w,_]=(0,r.useState)("versions"),[S,q]=(0,r.useState)(null),[C,P]=(0,r.useState)(null),[Z,A]=(0,r.useState)(!1),[z,T]=(0,r.useState)(!1),[D,M]=(0,r.useState)(!1),F=async()=>{try{k(!0);let e=await i.q.getVersions();s(e);let t=e.find(e=>"active"===e.status);t&&g(t)}catch(e){console.error("Failed to load versions:",e)}finally{k(!1)}},I=async e=>{try{let t=await i.q.getPatterns(e);y(t)}catch(e){console.error("Failed to load patterns:",e)}},E=async e=>{try{let t=await i.q.getTemplates(e);v(t)}catch(e){console.error("Failed to load templates:",e)}},U=async e=>{if(confirm(`Are you sure you want to promote "${e.name}" to active?`))try{await i.q.promoteVersion(e.id),F()}catch(e){console.error("Failed to promote version:",e)}},V=async e=>{if(confirm(`Are you sure you want to archive "${e.name}"?`))try{await i.q.archiveVersion(e.id),F()}catch(e){console.error("Failed to archive version:",e)}},$=async()=>{try{await i.q.reloadConfig(),alert("Configuration cache reloaded successfully")}catch(e){console.error("Failed to reload config:",e),alert("Failed to reload configuration")}},L=[{label:"Select",icon:a.jsx(o.Z,{size:14}),onClick:e=>g(e),variant:"secondary"},{label:"Promote",icon:a.jsx(c.Z,{size:14}),onClick:U,variant:"primary",disabled:e=>"active"===e.status},{label:"Archive",icon:a.jsx(d,{size:14}),onClick:V,variant:"danger",disabled:e=>"active"===e.status}],R=[{label:"Edit",icon:a.jsx(o.Z,{size:14}),onClick:e=>q(e),variant:"secondary"},{label:"Delete",icon:a.jsx(m.Z,{size:14}),onClick:async e=>{if(confirm("Are you sure you want to delete this pattern?"))try{await i.q.deletePattern(e.id),p&&I(p.id)}catch(e){console.error("Failed to delete pattern:",e)}},variant:"danger"}];return e?.permissions?.can_manage_intent_config||e?.permissions?.is_admin||e?.permissions?.is_super_admin?(0,a.jsxs)("div",{className:"p-4 sm:p-6",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 sm:mb-6 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-bold mb-2",children:"Intent Configuration"}),a.jsx("p",{className:"text-sm sm:text-base text-neutral-600",children:"Manage AI intent patterns and response templates"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(h.Z,{onClick:$,className:"btn-secondary flex items-center gap-2 text-sm",children:[a.jsx(x.Z,{size:16}),a.jsx("span",{className:"hidden sm:inline",children:"Reload Cache"}),a.jsx("span",{className:"sm:hidden",children:"Reload"})]}),(0,a.jsxs)(h.Z,{onClick:()=>A(!0),className:"flex items-center gap-2 text-sm",children:[a.jsx(u.Z,{size:16}),a.jsx("span",{className:"hidden sm:inline",children:"New Version"}),a.jsx("span",{className:"sm:hidden",children:"New"})]})]})]}),a.jsx("div",{className:"border-b border-neutral-200 dark:border-neutral-700 mb-4 sm:mb-6",children:a.jsx("nav",{className:"flex space-x-4 sm:space-x-8 overflow-x-auto",children:["versions","patterns","templates","logs","test"].map(e=>a.jsx("button",{onClick:()=>_(e),className:`py-2 px-1 border-b-2 font-medium text-xs sm:text-sm whitespace-nowrap ${w===e?"border-[--color-brand] text-[--color-brand]":"border-transparent text-neutral-500 hover:text-neutral-700 dark:hover:text-neutral-300"}`,children:e.charAt(0).toUpperCase()+e.slice(1)},e))})}),p&&"versions"!==w&&a.jsx("div",{className:"card p-3 sm:p-4 mb-4 sm:mb-6",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-semibold text-sm sm:text-base",children:["Working with: ",p.name]}),(0,a.jsxs)("p",{className:"text-xs sm:text-sm text-neutral-600",children:["Status: ",p.status," |",p.pattern_count," patterns, ",p.template_count," templates"]})]}),a.jsx(h.Z,{onClick:()=>_("versions"),className:"btn-secondary text-sm",children:"Change Version"})]})}),"versions"===w&&a.jsx(l.Z,{data:t,columns:[{key:"name",label:"Name",sortable:!0},{key:"status",label:"Status",render:e=>a.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${"active"===e?"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-200":"candidate"===e?"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200":"bg-gray-100 dark:bg-gray-900/30 text-gray-800 dark:text-gray-200"}`,children:e.toUpperCase()})},{key:"pattern_count",label:"Patterns",render:e=>e.toString()},{key:"template_count",label:"Templates",render:e=>e.toString()},{key:"created_at",label:"Created",render:e=>new Date(e).toLocaleDateString()}],actions:L,loading:N,searchable:!0,searchPlaceholder:"Search versions...",emptyMessage:"No configuration versions found"}),"patterns"===w&&p&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 gap-3",children:[a.jsx("h3",{className:"text-base sm:text-lg font-semibold",children:"Patterns"}),(0,a.jsxs)(h.Z,{onClick:()=>T(!0),className:"flex items-center gap-2 text-sm",children:[a.jsx(u.Z,{size:16}),"Add Pattern"]})]}),a.jsx(l.Z,{data:f,columns:[{key:"handler",label:"Handler",render:e=>a.jsx("code",{className:"text-xs sm:text-sm bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded",children:e})},{key:"intent",label:"Intent"},{key:"kind",label:"Kind",render:e=>a.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs ${"positive"===e?"bg-green-100 text-green-800":"negative"===e?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:e})},{key:"pattern",label:"Pattern",render:e=>a.jsx("code",{className:"text-xs max-w-xs truncate block",children:e})},{key:"priority",label:"Priority"},{key:"enabled",label:"Enabled",render:e=>e?"✅":"❌"}],actions:R,loading:N,searchable:!0,searchPlaceholder:"Search patterns...",emptyMessage:"No patterns found"})]}),"templates"===w&&p&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 gap-3",children:[a.jsx("h3",{className:"text-base sm:text-lg font-semibold",children:"Templates"}),(0,a.jsxs)(h.Z,{onClick:()=>M(!0),className:"flex items-center gap-2 text-sm",children:[a.jsx(u.Z,{size:16}),"Add Template"]})]}),a.jsx(l.Z,{data:j,columns:[{key:"handler",label:"Handler",render:e=>a.jsx("code",{className:"text-xs sm:text-sm bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded",children:e})},{key:"intent",label:"Intent",render:e=>e||"-"},{key:"template_type",label:"Type",render:e=>a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-purple-100 text-purple-800",children:e})},{key:"template_text",label:"Template",render:e=>a.jsx("div",{className:"max-w-xs sm:max-w-md truncate text-xs sm:text-sm",children:e})},{key:"enabled",label:"Enabled",render:e=>e?"✅":"❌"}],actions:[{label:"Edit",icon:a.jsx(o.Z,{size:14}),onClick:e=>P(e),variant:"secondary"},{label:"Delete",icon:a.jsx(m.Z,{size:14}),onClick:async e=>{if(confirm("Are you sure you want to delete this template?"))try{await i.q.deleteTemplate(e.id),p&&E(p.id)}catch(e){console.error("Failed to delete template:",e)}},variant:"danger"}],loading:N,searchable:!0,searchPlaceholder:"Search templates...",emptyMessage:"No templates found"})]}),"logs"===w&&(0,a.jsxs)("div",{className:"card p-4 sm:p-6",children:[a.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:"Routing Logs"}),a.jsx("p",{className:"text-sm sm:text-base text-neutral-600 mb-3 sm:mb-4",children:"View routing logs and analytics in the Logs section."}),a.jsx(h.Z,{onClick:()=>window.location.href="/admin/logs",className:"text-sm",children:"View Logs"})]}),"test"===w&&(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-4",children:"Test Classification"}),a.jsx(b,{})]})]}):a.jsx("div",{className:"p-4 sm:p-6",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-bold mb-4",children:"Access Denied"}),a.jsx("p",{className:"text-neutral-600",children:"You don't have permission to manage intent configuration."})]})})}function b(){let[e,t]=(0,r.useState)(""),[s,n]=(0,r.useState)(null),[l,o]=(0,r.useState)(!1),c=async()=>{if(e.trim())try{o(!0);let t=await i.q.testClassify({message:e});n(t)}catch(e){console.error("Test failed:",e)}finally{o(!1)}};return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label text-sm",children:"Test Message"}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[a.jsx("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"Enter a message to test classification...",className:"input flex-1 text-sm"}),(0,a.jsxs)(h.Z,{onClick:c,disabled:l||!e.trim(),className:"flex items-center gap-2 text-sm",children:[a.jsx(p.Z,{size:16}),l?"Testing...":"Test"]})]})]}),s&&(0,a.jsxs)("div",{className:"card p-3 sm:p-4",children:[a.jsx("h4",{className:"font-semibold mb-3 text-sm sm:text-base",children:"Classification Result"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[a.jsx("strong",{className:"text-sm",children:"Final Decision:"}),a.jsx("pre",{className:"mt-1 p-2 bg-gray-100 dark:bg-gray-800 rounded text-xs sm:text-sm overflow-auto",children:JSON.stringify(s.final_decision,null,2)})]}),s.config_router_result&&(0,a.jsxs)("div",{children:[a.jsx("strong",{className:"text-sm",children:"Config Router:"}),a.jsx("pre",{className:"mt-1 p-2 bg-blue-50 dark:bg-blue-900/20 rounded text-xs sm:text-sm overflow-auto",children:JSON.stringify(s.config_router_result,null,2)})]}),s.llm_classifier_result&&(0,a.jsxs)("div",{children:[a.jsx("strong",{className:"text-sm",children:"LLM Classifier:"}),a.jsx("pre",{className:"mt-1 p-2 bg-green-50 dark:bg-green-900/20 rounded text-xs sm:text-sm overflow-auto",children:JSON.stringify(s.llm_classifier_result,null,2)})]}),(0,a.jsxs)("div",{children:[a.jsx("strong",{className:"text-sm",children:"Processing Steps:"}),a.jsx("ul",{className:"mt-1 space-y-1",children:s.processing_steps.map((e,t)=>(0,a.jsxs)("li",{className:"text-xs sm:text-sm text-neutral-600",children:[t+1,". ",e]},t))})]})]})]})]})}},1691:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>i,__esModule:()=>n,default:()=>l});var a=s(8570);let r=(0,a.createProxy)(String.raw`/Users/ericmwirichia/Documents/SchoolAI/admin-frontend/app/admin/intent-config/page.tsx`),{__esModule:n,$$typeof:i}=r;r.default;let l=(0,a.createProxy)(String.raw`/Users/ericmwirichia/Documents/SchoolAI/admin-frontend/app/admin/intent-config/page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[226,784,392,832,263],()=>s(3721));module.exports=a})();