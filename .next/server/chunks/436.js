exports.id=436,exports.ids=[436],exports.modules={6276:(e,t,a)=>{Promise.resolve().then(a.bind(a,5529))},5529:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var r=a(326);a(7577);var l=a(7285),s=a(798);function n({children:e}){let{isAuthenticated:t,isLoading:a}=(0,s.x)();return a?r.jsx("div",{className:"h-svh flex items-center justify-center",children:r.jsx("div",{className:"text-neutral-500",children:"Loading..."})}):t?r.jsx(l.ZP,{children:e}):r.jsx("div",{className:"h-svh flex items-center justify-center",children:r.jsx("div",{className:"text-neutral-500",children:"Redirecting to login..."})})}},593:(e,t,a)=>{"use strict";a.d(t,{Z:()=>c});var r=a(326),l=a(7577),s=a(3136),n=a(434);let i=(0,a(2881).Z)("menu",[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]]);function o({open:e,onClose:t,onLogout:a,userLabel:l,email:s,schoolId:n}){if(!e)return null;let i=(l||s||"U").slice(0,1).toUpperCase();return(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 z-[90] bg-black/40 backdrop-blur-[2px]",onClick:t}),(0,r.jsxs)("div",{className:"fixed right-4 top-16 z-[100] w-[360px] sm:w-[380px] rounded-[1.25rem] card border border-neutral-200/60 overflow-hidden shadow-[var(--shadow-soft)]",onClick:e=>e.stopPropagation(),role:"dialog","aria-modal":"true",children:[(0,r.jsxs)("div",{className:"relative px-4 py-3 bg-neutral-900/5 dark:bg-white/5",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-[--color-brand] text-white font-semibold",children:i}),(0,r.jsxs)("div",{className:"min-w-0",children:[s&&r.jsx("div",{className:"text-xs text-neutral-500 dark:text-neutral-400 truncate",children:s}),r.jsx("div",{className:"text-sm font-medium truncate",children:l||"User"})]})]}),r.jsx("button",{onClick:t,className:"absolute right-3 top-3 text-neutral-500 hover:text-neutral-800 dark:hover:text-neutral-200","aria-label":"Close",children:"✕"})]}),(0,r.jsxs)("div",{className:"px-5 pt-4 pb-3",children:[(0,r.jsxs)("div",{className:"text-lg font-semibold",children:["Hi",l?`, ${l.split(" ")[0]}!`:"!"]}),r.jsx("button",{className:"mt-3 btn-primary w-full rounded-xl py-2.5",onClick:()=>alert("Manage account (stub)"),children:"Manage your Account"})]}),r.jsx("div",{className:"mx-4 mb-3 rounded-2xl bg-neutral-100 dark:bg-neutral-800 p-4",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:"text-xl leading-none",children:"\uD83C\uDFE0"}),(0,r.jsxs)("div",{className:"text-sm",children:[r.jsx("div",{className:"font-medium",children:"Set your school & year"}),r.jsx("div",{className:"text-neutral-600 dark:text-neutral-400",children:"Pick active school and academic year for better results."}),(0,r.jsxs)("div",{className:"mt-2 flex gap-3",children:[r.jsx("button",{className:"btn rounded-lg px-3 py-1.5 hover:bg-neutral-200 dark:hover:bg-neutral-700",children:"Dismiss"}),r.jsx("button",{className:"link-subtle",children:"Open settings"})]})]})]})}),r.jsx("div",{className:"px-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[r.jsx("button",{className:"btn rounded-xl px-3 py-2 bg-neutral-100 dark:bg-neutral-800 hover:bg-neutral-200 dark:hover:bg-neutral-700",onClick:()=>alert("Add account (stub)"),children:"+ Add account"}),r.jsx("button",{className:"btn rounded-xl px-3 py-2 bg-neutral-100 dark:bg-neutral-800 hover:bg-neutral-200 dark:hover:bg-neutral-700",onClick:()=>{t(),a()},children:"Sign out"})]})}),r.jsx("div",{className:"mt-3 px-2 pb-2",children:(0,r.jsxs)("ul",{className:"grid gap-2",children:[r.jsx("li",{children:(0,r.jsxs)("button",{className:"w-full text-left rounded-xl px-3 py-2 hover:bg-neutral-100 dark:hover:bg-neutral-800",children:["\uD83D\uDD0E ",r.jsx("span",{className:"ml-2",children:"Search history"}),r.jsx("span",{className:"float-right text-xs text-neutral-500",children:"Not saving"})]})}),r.jsx("li",{children:(0,r.jsxs)("button",{className:"w-full text-left rounded-xl px-3 py-2 hover:bg-neutral-100 dark:hover:bg-neutral-800",children:["\uD83D\uDCC1 ",r.jsx("span",{className:"ml-2",children:"Saves & Collections"})]})}),r.jsx("li",{children:(0,r.jsxs)("button",{className:"w-full text-left rounded-xl px-3 py-2 hover:bg-neutral-100 dark:hover:bg-neutral-800",children:["✨ ",r.jsx("span",{className:"ml-2",children:"Search personalization"})]})}),(0,r.jsxs)("li",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsxs)("button",{className:"rounded-xl px-3 py-2 hover:bg-neutral-100 dark:hover:bg-neutral-800 text-left",children:["\uD83D\uDEE1️ ",r.jsx("span",{className:"ml-2",children:"SafeSearch"}),r.jsx("div",{className:"text-xs text-neutral-500 ml-7 -mt-1",children:"Blurring on"})]}),(0,r.jsxs)("button",{className:"rounded-xl px-3 py-2 hover:bg-neutral-100 dark:hover:bg-neutral-800 text-left",children:["\uD83C\uDF10 ",r.jsx("span",{className:"ml-2",children:"Language"}),r.jsx("div",{className:"text-xs text-neutral-500 ml-7 -mt-1",children:"English"})]})]}),(0,r.jsxs)("li",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsxs)("button",{className:"rounded-xl px-3 py-2 hover:bg-neutral-100 dark:hover:bg-neutral-800 text-left",children:["⚙️ ",r.jsx("span",{className:"ml-2",children:"More settings"})]}),(0,r.jsxs)("button",{className:"rounded-xl px-3 py-2 hover:bg-neutral-100 dark:hover:bg-neutral-800 text-left",children:["❔ ",r.jsx("span",{className:"ml-2",children:"Help"})]})]})]})}),(0,r.jsxs)("div",{className:"px-4 py-3 flex items-center justify-between text-xs text-neutral-600 dark:text-neutral-400 border-t border-neutral-200/70 dark:border-white/10",children:[r.jsx("div",{children:"Privacy Policy"}),r.jsx("div",{children:"Terms of Service"})]})]})]})}var d=a(7285);function c(){let{token:e,active_school_id:t,logout:a}=(0,s.a)(),[c,u]=(0,l.useState)(!1),[x,h]=(0,l.useState)(!1),[m,p]=(0,l.useState)(!1),[v,b]=(0,l.useState)(""),[f,g]=(0,l.useState)(""),j=(0,l.useRef)(null),k=(0,l.useMemo)(()=>(function(e){if(!e)return null;try{let t=e.split(".")[1]?.replace(/-/g,"+").replace(/_/g,"/"),a=atob(t);return JSON.parse(a)}catch{return null}})(e||void 0),[e]),N=k?.full_name,y=k?.email,w=N||y||"Guest",C=function(e,t){let a=(e||"").trim();return a?a.split(/\s+/).slice(0,2).map(e=>e[0]?.toUpperCase()||"").join("")||"U":t&&t[0]?.toUpperCase()||"U"}(N,y),M=t??k?.active_school_id;return(0,r.jsxs)("header",{className:"flex items-center justify-between px-4 py-3 border-b border-neutral-200 dark:border-neutral-800 bg-white dark:bg-neutral-900",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[m&&r.jsx("button",{onClick:()=>{d.z5.send({type:"toggle"})},className:"p-2 -ml-2 rounded-md hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors","aria-label":"Toggle sidebar",children:r.jsx(i,{size:20,className:"text-neutral-600 dark:text-neutral-400"})}),v&&(0,r.jsxs)("div",{className:"min-w-0 flex-1",children:[r.jsx("h1",{className:"text-base sm:text-lg font-semibold text-neutral-900 dark:text-neutral-100 truncate",children:v}),f&&r.jsx("p",{className:"text-xs sm:text-sm text-neutral-600 dark:text-neutral-400 truncate",children:f})]})]}),r.jsx("div",{className:"flex items-center flex-shrink-0",children:e?(0,r.jsxs)("div",{className:"relative",ref:j,children:[r.jsx("button",{onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),onClick:()=>u(!0),className:"inline-flex h-10 w-10 items-center justify-center  rounded-full bg-[--color-brand] text-white font-semibold text-sm shadow-lg hover:shadow-xl ring-2 ring-[--color-brand]/30 dark:ring-[--color-brand]/40 border-2 border-[--color-brand-light]/50 hover:scale-105 active:scale-95 transition-all duration-200 ease-out","aria-label":"User menu",title:w,children:C}),x&&(0,r.jsxs)("div",{className:"absolute right-0 mt-2 card px-3 py-2 text-xs min-w-[200px] z-50",onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),children:[r.jsx("div",{className:"font-medium truncate",children:w}),y&&r.jsx("div",{className:"text-neutral-600 dark:text-neutral-400 truncate",children:y})]}),r.jsx(o,{open:c,onClose:()=>u(!1),onLogout:a,userLabel:w,email:y||void 0,schoolId:M})]}):(0,r.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[r.jsx(n.default,{className:"link-subtle",href:"/login",children:"Login"}),r.jsx(n.default,{className:"link-subtle",href:"/signup",children:"Sign up"})]})})]})}},7285:(e,t,a)=>{"use strict";a.d(t,{z5:()=>D,ZP:()=>Z});var r=a(326),l=a(7577),s=a(5047),n=a(9366),i=a(3136),o=a(2366),d=a(2881);let c=(0,d.Z)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);var u=a(3855),x=a(6968);let h=(0,d.Z)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);var m=a(1405);let p=(0,d.Z)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),v=(0,d.Z)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]);var b=a(246);let f=(0,d.Z)("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]),g=(0,d.Z)("archive-restore",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h2",key:"tvwodi"}],["path",{d:"M20 8v11a2 2 0 0 1-2 2h-2",key:"1gkqxj"}],["path",{d:"m9 15 3-3 3 3",key:"1pd0qc"}],["path",{d:"M12 12v9",key:"192myk"}]]),j=(0,d.Z)("archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]),k=(0,d.Z)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);var N=a(8091),y=a(962);function w({isOpen:e,title:t,message:a,confirmText:l="Confirm",cancelText:s="Cancel",onConfirm:n,onCancel:i,variant:o="default"}){if(!e)return null;let d=(()=>{switch(o){case"danger":return{backgroundColor:"var(--color-error)",color:"white",onHover:"var(--color-error-dark)"};case"warning":return{backgroundColor:"var(--color-warning)",color:"white",onHover:"var(--color-warning-dark)"};case"success":return{backgroundColor:"var(--color-success)",color:"white",onHover:"var(--color-success-dark)"};default:return{backgroundColor:"var(--color-brand)",color:"white",onHover:"var(--color-brand-dark)"}}})(),c=(0,r.jsxs)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",children:[r.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:i}),(0,r.jsxs)("div",{className:"relative bg-white dark:bg-neutral-800 rounded-2xl shadow-2xl max-w-md w-full p-6 border border-neutral-200 dark:border-neutral-700",children:[(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-neutral-900 dark:text-neutral-100 mb-2",children:t}),r.jsx("p",{className:"text-neutral-600 dark:text-neutral-400",children:a})]}),(0,r.jsxs)("div",{className:"flex gap-3 justify-end",children:[r.jsx("button",{onClick:i,className:"px-4 py-2 rounded-lg border border-neutral-300 dark:border-neutral-600  bg-white dark:bg-neutral-800 text-neutral-700 dark:text-neutral-300 hover:bg-neutral-50 dark:hover:bg-neutral-700  transition-colors font-medium",children:s}),r.jsx("button",{onClick:n,className:"px-4 py-2 rounded-lg transition-colors font-medium",style:{backgroundColor:d.backgroundColor,color:d.color},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=d.onHover},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=d.backgroundColor},children:l})]})]})]});return"undefined"!=typeof document?(0,y.createPortal)(c,document.body):null}function C({chat:e,onUpdate:t,onDelete:a,forceVisible:s=!1}){let[i,o]=(0,l.useState)(!1),[d,c]=(0,l.useState)(!1),[u,x]=(0,l.useState)(!1),[h,m]=(0,l.useState)(e.title),[p,v]=(0,l.useState)(!1),b=(0,l.useRef)(null),y=(0,l.useRef)(null),C=async a=>{if(a.preventDefault(),a.stopPropagation(),!p){v(!0);try{let a=await n.A.updateConversation(e.id,{is_archived:!e.is_archived});t(e.id,a)}catch(e){console.error("Failed to toggle archive:",e)}finally{v(!1),o(!1)}}},M=async a=>{if(a.preventDefault(),a.stopPropagation(),p)return;let r=h.trim();if(r&&r!==e.title){v(!0);try{let a=await n.A.updateConversation(e.id,{title:r});t(e.id,a)}catch(t){console.error("Failed to rename chat:",t),m(e.title)}finally{v(!1)}}c(!1)},S=()=>{m(e.title),c(!1)},z=async()=>{if(!p){v(!0);try{await n.A.deleteConversation(e.id),a(e.id)}catch(e){console.error("Failed to delete chat:",e)}finally{v(!1),x(!1)}}};return d?r.jsx("form",{onSubmit:M,className:"flex-1 mr-2",children:r.jsx("input",{ref:y,type:"text",value:h,onChange:e=>m(e.target.value),onBlur:S,onKeyDown:e=>{"Escape"===e.key&&S()},className:"w-full px-2 py-1 text-sm bg-white dark:bg-neutral-800 border border-neutral-300 dark:border-neutral-600 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:e=>e.stopPropagation(),disabled:p,maxLength:255})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"relative",ref:b,children:[r.jsx("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),o(!i)},className:`p-1 rounded-md hover:bg-neutral-200 dark:hover:bg-neutral-700 transition-opacity disabled:opacity-50 ${s?"opacity-100":"opacity-0 group-hover:opacity-100"}`,title:"Chat options",disabled:p,children:r.jsx(f,{size:16})}),i&&(0,r.jsxs)("div",{className:"absolute right-0 top-full mt-1 bg-white dark:bg-neutral-800 rounded-lg shadow-xl border border-neutral-200 dark:border-neutral-700 py-1 z-50 min-w-[160px]",children:[r.jsx("button",{onClick:C,disabled:p,className:"w-full text-left px-3 py-2 text-sm hover:bg-neutral-100 dark:hover:bg-neutral-700 flex items-center gap-2 transition-colors disabled:opacity-50",children:e.is_archived?(0,r.jsxs)(r.Fragment,{children:[r.jsx(g,{size:16}),"Unarchive"]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(j,{size:16}),"Archive"]})}),(0,r.jsxs)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),c(!0),o(!1)},disabled:p,className:"w-full text-left px-3 py-2 text-sm hover:bg-neutral-100 dark:hover:bg-neutral-700 flex items-center gap-2 transition-colors disabled:opacity-50",children:[r.jsx(k,{size:16}),"Rename"]}),(0,r.jsxs)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),o(!1),x(!0)},disabled:p,className:"w-full text-left px-3 py-2 text-sm hover:bg-neutral-100 dark:hover:bg-neutral-700 flex items-center gap-2 text-red-600 dark:text-red-400 transition-colors disabled:opacity-50",children:[r.jsx(N.Z,{size:16}),"Delete"]})]})]}),r.jsx(w,{isOpen:u,title:"Delete chat",message:"Are you sure you want to delete this chat?",confirmText:"Delete",cancelText:"Cancel",variant:"danger",onConfirm:z,onCancel:()=>{x(!1)}})]})}function M({collapsed:e,onCollapse:t,isMobile:a=!1}){let[d,f]=(0,l.useState)([]),[g,j]=(0,l.useState)(!1),[k,N]=(0,l.useState)(!0),[y,w]=(0,l.useState)(!1),[M,S]=(0,l.useState)(null),z=(0,l.useRef)(null),{token:_,logout:D,isAuthenticated:Z}=(0,i.a)(),P=(0,s.usePathname)(),U=(0,s.useRouter)(),R=(0,l.useMemo)(()=>{let e=P.match(/\/chat\/([^/]+)/);return e?e[1]:null},[P]),L=(0,l.useMemo)(()=>(function(e){if(!e)return null;try{let t=e.split(".")[1]?.replace(/-/g,"+").replace(/_/g,"/"),a=atob(t);return JSON.parse(a)}catch{return null}})(_||void 0),[_]),F=L?.full_name,$=L?.email,A=L?.active_school_id,T=F||$||"Guest",H=function(e,t){let a=(e||"").trim();return a?a.split(/\s+/).slice(0,2).map(e=>e[0]?.toUpperCase()||"").join("")||"U":t&&t[0]?.toUpperCase()||"U"}(F,$),E=(0,l.useCallback)(()=>{e||t(!0)},[e,t]),V=(0,l.useCallback)(async(e=!1)=>{if(Z)try{e?w(!0):N(!0),S(null);let t=(await n.A.getConversations(1,50,!1)).conversations.map(e=>({id:e.id,title:e.title,is_starred:!1,last_activity:e.last_activity,message_count:e.message_count,is_archived:e.is_archived}));f(t)}catch(e){console.error("Failed to load chats:",e),S("Failed to load chats"),f([])}finally{N(!1),w(!1)}},[Z]);!function(e,t=3e4){(function(e={}){let{onConversationCreated:t,onConversationUpdated:a,onConversationDeleted:r,onMessageSent:s,onForceRefresh:n,enableAutoRefresh:i=!0,refreshInterval:d=3e4}=e,c=(0,o.rc)()??void 0;(0,l.useRef)(),(0,l.useCallback)(()=>{o.MN.forceRefresh(c)},[c]),(0,l.useCallback)((e,t)=>{o.MN.conversationCreated(e,t,c)},[c]),(0,l.useCallback)((e,t)=>{o.MN.conversationUpdated(e,t,c)},[c]),(0,l.useCallback)(e=>{o.MN.conversationDeleted(e,c)},[c]),(0,l.useCallback)((e,t)=>{o.MN.messageSent(e,t,c)},[c])})({onConversationCreated:e,onConversationUpdated:e,onConversationDeleted:e,onMessageSent:e,onForceRefresh:e,enableAutoRefresh:!0,refreshInterval:t})}((0,l.useCallback)(()=>V(!0),[V]),3e4);let O=(e,t)=>{f(a=>a.map(a=>a.id===e?{...a,title:t.title||a.title,is_starred:void 0===t.is_archived&&a.is_starred,is_archived:void 0!==t.is_archived?t.is_archived:a.is_archived}:a).sort((e,t)=>e.is_starred!==t.is_starred?(t.is_starred?1:0)-(e.is_starred?1:0):new Date(t.last_activity).getTime()-new Date(e.last_activity).getTime()))},I=e=>{f(t=>t.filter(t=>t.id!==e)),R===e&&(U.replace("/chat/new"),E())},B=()=>{V(!0)},q=e=>{U.push(`/chat/${e}`),E()};return Z?(0,r.jsxs)("aside",{className:`
        border-r border-neutral-200/70 dark:border-white/10 
        bg-white/70 dark:bg-neutral-900/60 backdrop-blur 
        flex flex-col h-full transition-all duration-300
        ${e?"w-[70px] cursor-pointer":"w-[260px]"}
      `,onClick:e?()=>t(!1):void 0,children:[r.jsx("div",{className:"px-2 py-3",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("div",{className:"flex items-center ml-2",children:e?r.jsx(b.K7,{size:"sm"}):r.jsx(b.ZP,{size:"sm",href:"/"})}),!e&&r.jsx("div",{className:"flex items-center gap-1",children:r.jsx("button",{onClick:()=>t(!0),className:"p-1 rounded-md hover:bg-neutral-100 dark:hover:bg-neutral-800",title:"Collapse sidebar",children:r.jsx(c,{size:18})})})]})}),r.jsx("div",{className:"px-2 pb-2",onClick:e?e=>e.stopPropagation():void 0,children:(0,r.jsxs)("button",{className:"w-full rounded-xl py-2 px-1 flex items-center font-medium transition-colors duration-200 hover:bg-neutral-100 dark:hover:bg-neutral-800",style:{color:"var(--color-brand)"},onClick:()=>{U.push("/"),E()},title:"New Chat",children:[r.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0 ml-2",style:{backgroundColor:"var(--color-brand)"},children:r.jsx(u.Z,{size:14,className:"text-white"})}),!e&&r.jsx("div",{className:"ml-3 overflow-hidden",children:r.jsx("span",{className:"whitespace-nowrap block",children:"New Chat"})})]})}),A&&r.jsx("div",{className:"px-2 pb-2",onClick:e?e=>e.stopPropagation():void 0,children:(0,r.jsxs)("button",{onClick:()=>{U.push(`/school/${A}`),E()},className:"w-full flex items-center px-1 py-2 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors text-neutral-700 dark:text-neutral-200",title:e?"My School":void 0,children:[r.jsx(x.Z,{size:18,className:"flex-shrink-0 ml-2"}),!e&&r.jsx("div",{className:"ml-3 overflow-hidden",children:r.jsx("span",{className:"text-sm font-medium whitespace-nowrap block",children:"My School"})})]})}),!e&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"px-2 py-1 flex items-center justify-between",children:[r.jsx("h3",{className:"text-xs uppercase tracking-wide text-neutral-500 dark:text-neutral-400 font-medium",children:"Recents"}),(y||k)&&r.jsx("div",{className:"w-3 h-3 border border-neutral-300 dark:border-neutral-600 border-t-transparent rounded-full animate-spin"})]}),r.jsx("div",{className:"flex-1 overflow-auto px-2",children:r.jsx("div",{className:"space-y-0.5",children:k&&!y?r.jsx("div",{className:"px-3 py-2 text-sm text-neutral-500",children:"Loading chats..."}):M?(0,r.jsxs)("div",{className:"px-3 py-2 text-sm text-red-500",children:[M,r.jsx("button",{onClick:B,className:"block mt-1 text-xs text-blue-500 hover:underline",children:"Retry"})]}):0===d.length?(0,r.jsxs)("div",{className:"px-3 py-2 text-sm text-neutral-500",children:["No chats yet.",r.jsx("button",{onClick:B,className:"block mt-1 text-xs text-blue-500 hover:underline",children:"Refresh"})]}):d.map(e=>{let t=R===e.id;return(0,r.jsxs)("div",{className:`
                        group flex items-center rounded-lg transition-colors
                        ${t?"bg-neutral-200 dark:bg-neutral-700 hover:bg-neutral-250 dark:hover:bg-neutral-650":"hover:bg-neutral-100 dark:hover:bg-neutral-800"}
                      `,children:[(0,r.jsxs)("button",{onClick:()=>q(e.id),className:"flex items-center flex-1 px-3 py-1.5 min-w-0 text-left rounded-lg hover:bg-transparent",children:[e.is_starred&&r.jsx(h,{size:14,className:"mr-2 text-yellow-400 fill-yellow-400 flex-shrink-0"}),r.jsx("div",{className:"flex-1 min-w-0",children:r.jsx("span",{className:"block truncate text-sm text-neutral-700 dark:text-neutral-200",children:e.title})})]}),r.jsx("div",{className:"flex-shrink-0",children:r.jsx(C,{chat:{id:e.id,title:e.title,first_message:"",last_activity:e.last_activity,message_count:e.message_count,is_archived:e.is_archived,created_at:e.last_activity},onUpdate:(e,t)=>O(e,t),onDelete:I,forceVisible:t})})]},e.id)})})})]}),e&&r.jsx("div",{className:"flex-1"}),_&&r.jsx("div",{className:"border-t border-neutral-200/70 dark:border-white/10 p-3 mt-auto",onClick:e?e=>e.stopPropagation():void 0,children:(0,r.jsxs)("div",{className:"relative",ref:z,children:[(0,r.jsxs)("button",{onClick:()=>j(!g),className:`
                w-full flex items-center gap-3 p-2 rounded-lg 
                hover:bg-neutral-100 dark:hover:bg-neutral-800 
                transition-all duration-200 ease-out
                ${e?"justify-center":""}
              `,title:e?`${T}${$?` - ${$}`:""}`:void 0,"aria-label":"User menu",children:[r.jsx("div",{className:" inline-flex h-8 w-8 items-center justify-center  rounded-full text-white font-semibold text-sm shadow-md hover:shadow-lg ring-2 ring-blue-500/20 dark:ring-blue-400/30 border border-blue-300/30 hover:scale-105 active:scale-95 transition-all duration-200 ease-out flex-shrink-0 ",style:{backgroundColor:"var(--color-brand)"},children:H}),!e&&(0,r.jsxs)("div",{className:"flex-1 text-left min-w-0",children:[r.jsx("div",{className:"text-sm font-medium truncate",children:T}),$&&r.jsx("div",{className:"text-xs text-neutral-500 dark:text-neutral-400 truncate",children:$})]})]}),g&&(0,r.jsxs)("div",{className:`
                  absolute bottom-full mb-2 bg-white dark:bg-neutral-900 rounded-lg 
                  shadow-xl border border-neutral-200 dark:border-neutral-700 py-1 z-50
                  backdrop-blur-sm
                  ${e?"left-full ml-2 w-48":"left-0 right-0"}
                `,children:[e&&(0,r.jsxs)("div",{className:"px-3 py-2 border-b border-neutral-200 dark:border-neutral-700",children:[r.jsx("div",{className:"font-medium text-sm truncate",children:T}),$&&r.jsx("div",{className:"text-xs text-neutral-500 dark:text-neutral-400 truncate",children:$})]}),(0,r.jsxs)("button",{onClick:()=>{j(!1),B()},className:"w-full text-left px-3 py-2 text-sm hover:bg-neutral-100 dark:hover:bg-neutral-700 flex items-center gap-2 transition-colors",children:[r.jsx(m.Z,{size:16}),"Refresh Chats"]}),(0,r.jsxs)("button",{onClick:()=>{j(!1),U.push("/settings/profile"),E()},className:"w-full text-left px-3 py-2 text-sm hover:bg-neutral-100 dark:hover:bg-neutral-700 flex items-center gap-2 transition-colors",children:[r.jsx(p,{size:16}),"Settings"]}),(0,r.jsxs)("button",{onClick:()=>{D(),j(!1)},className:"w-full text-left px-3 py-2 text-sm hover:bg-neutral-100 dark:hover:bg-neutral-700 flex items-center gap-2 text-red-600 dark:text-red-400 transition-colors",children:[r.jsx(v,{size:16}),"Logout"]})]})]})})]}):null}function S({open:e,width:t,onResize:a,onRequestClose:s}){let[n,i]=(0,l.useState)(!1),o=(0,l.useRef)(0);return((0,l.useRef)(t),e)?(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"absolute inset-0 z-[45]",onClick:s}),(0,r.jsxs)("div",{className:"relative z-[50] h-[calc(100svh-48px)] border-l border-neutral-200/70 dark:border-white/10 bg-white/80 dark:bg-neutral-900/70 backdrop-blur",style:{width:t},onClick:e=>e.stopPropagation(),children:[r.jsx("div",{onMouseDown:e=>{i(!0),o.current=e.clientX},className:"absolute left-0 top-0 h-full w-1 cursor-col-resize bg-transparent",title:"Drag to resize",children:r.jsx("div",{className:"absolute left-[-2px] top-1/2 -translate-y-1/2 h-10 w-[3px] rounded-full bg-neutral-300/70 dark:bg-neutral-700/70"})}),(0,r.jsxs)("div",{className:"h-full overflow-auto p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("div",{className:"font-medium",children:"Canvas"}),r.jsx("button",{onClick:s,className:"btn rounded-lg px-3 py-1.5 hover:bg-neutral-100 dark:hover:bg-neutral-800",children:"Close"})]}),(0,r.jsxs)("div",{className:"card p-4",children:[r.jsx("p",{className:"text-sm text-neutral-700 dark:text-neutral-300",children:"This area can show context, notes, inspector panels, or AI tools. Use the shell’s “Show Canvas” button or call the bus:"}),r.jsx("pre",{className:"mt-3 rounded-xl bg-neutral-100 dark:bg-neutral-800 p-3 text-xs overflow-auto",children:`import { CanvasBus } from '@/components/layout/WorkspaceShell'

// Open with a custom width
CanvasBus.send({ type: 'open', width: 520 })

// Toggle
CanvasBus.send({ type: 'toggle' })
`})]})]})]})]}):r.jsx("div",{style:{width:0}})}var z=a(593);let _=new Set,D={send(e){_.forEach(t=>t(e))},on:e=>(_.add(e),()=>{_.delete(e)})};function Z({children:e}){let[t,a]=(0,l.useState)(!0),[s,n]=(0,l.useState)(!1),i=e=>{console.log("Toggle sidebar called:",{newState:e,currentCollapsed:t,isMobile:s}),a(t=>{let a=void 0!==e?e:!t;return console.log("Sidebar state changing from",t,"to",a),s||localStorage.setItem("sidebar_collapsed",a?"1":"0"),a})},[o,d]=(0,l.useState)(!1),[c,u]=(0,l.useState)(420);return r.jsx("div",{className:"h-svh w-full overflow-hidden",children:(0,r.jsxs)("div",{className:"flex-1 overflow-hidden relative h-full",children:[s&&!t&&r.jsx("div",{className:"fixed inset-0 bg-black/50 z-30",onClick:()=>i(!0)}),(0,r.jsxs)("div",{className:"relative flex overflow-hidden h-full",children:[r.jsx("div",{className:`
            transition-all duration-300 ease-in-out
            ${s?`fixed left-0 top-0 h-full w-80 z-40 ${t?"-translate-x-full":"translate-x-0"}`:`relative z-10 ${t?"w-16":"w-auto"}`}
          `,children:r.jsx(M,{collapsed:t&&!s,onCollapse:i,isMobile:s})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0 flex flex-col h-full overflow-hidden",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx(z.Z,{})}),r.jsx("div",{className:"flex-1 min-h-0 overflow-hidden",children:e})]}),!s&&r.jsx(S,{open:o,width:c,onResize:u,onRequestClose:()=>d(!1)})]})]})})}},246:(e,t,a)=>{"use strict";a.d(t,{D2:()=>u,K7:()=>x,ZP:()=>c});var r=a(326),l=a(434),s=a(9360),n=a(1135);let i=(0,s.j)("flex items-center gap-3",{variants:{size:{sm:"",md:"",lg:""}},defaultVariants:{size:"sm"}}),o=(0,s.j)("relative rounded-xl bg-gradient-to-br from-[#1f7daf] to-[#104f73] grid place-items-center text-white font-bold shadow-lg ring-2 ring-[#1f7daf]/20",{variants:{size:{sm:"h-9 w-9 text-lg",md:"h-12 w-12 text-xl",lg:"h-16 w-16 text-2xl"}},defaultVariants:{size:"sm"}}),d=(0,s.j)("font-semibold bg-gradient-to-r from-[#1f7daf] to-[#104f73] bg-clip-text text-transparent",{variants:{size:{sm:"text-xl",md:"text-2xl",lg:"text-3xl"}},defaultVariants:{size:"sm"}});function c({size:e="sm",href:t="/",className:a,showText:s=!0}){let c=(0,r.jsxs)("div",{className:(0,n.Z)(i({size:e}),a),children:[r.jsx("div",{className:o({size:e}),children:r.jsx("span",{className:"drop-shadow-sm",children:"O"})}),s&&r.jsx("span",{className:d({size:e}),children:"Olaji"})]});return t?r.jsx(l.default,{href:t,children:c}):c}function u({className:e}){return r.jsx(c,{size:"sm",className:e})}function x({size:e="sm",className:t}){return r.jsx(c,{size:e,showText:!1,href:void 0,className:t})}},6968:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(2881).Z)("graduation-cap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]])},3855:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(2881).Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},1405:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(2881).Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},8091:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(2881).Z)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},1959:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$typeof:()=>n,__esModule:()=>s,default:()=>i});var r=a(8570);let l=(0,r.createProxy)(String.raw`/Users/ericmwirichia/Documents/SchoolAI/doneFrontend/app/(workspace)/layout.tsx`),{__esModule:s,$$typeof:n}=l;l.default;let i=(0,r.createProxy)(String.raw`/Users/ericmwirichia/Documents/SchoolAI/doneFrontend/app/(workspace)/layout.tsx#default`)}};