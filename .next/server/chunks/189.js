exports.id=189,exports.ids=[189],exports.modules={7529:()=>{},2189:(e,t,s)=>{Promise.resolve().then(s.bind(s,3136))},1625:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2994,23)),Promise.resolve().then(s.t.bind(s,6114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,9671,23)),Promise.resolve().then(s.t.bind(s,1868,23)),Promise.resolve().then(s.t.bind(s,4759,23))},3136:(e,t,s)=>{"use strict";s.d(t,{AuthProvider:()=>i,a:()=>c});var r=s(326),o=s(7577),a=s(5047);let n=(0,o.createContext)({token:null,active_school_id:null,isLoading:!0,login:async()=>{},logout:()=>{},setSchoolId:()=>{},isAuthenticated:!1});function i({children:e}){let[t,s]=(0,o.useState)({token:null,active_school_id:null,isLoading:!0}),i=(0,a.useRouter)(),c=async e=>{localStorage.setItem("token",e.token),s(t=>({...t,token:e.token,isLoading:!1}))},l={...t,login:c,logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("active_school_id"),s({token:null,active_school_id:null,isLoading:!1}),i.replace("/login")},setSchoolId:e=>{localStorage.setItem("active_school_id",e),s(t=>({...t,active_school_id:e}))},isAuthenticated:!!t.token&&!t.isLoading};return r.jsx(n.Provider,{value:l,children:e})}let c=()=>(0,o.useContext)(n)},798:(e,t,s)=>{"use strict";s.d(t,{x:()=>a}),s(7577);var r=s(5047),o=s(3136);function a(e="/login"){let{token:t,isLoading:s}=(0,o.a)();return(0,r.useRouter)(),{isAuthenticated:!!t&&!s,isLoading:s}}},2374:(e,t,s)=>{"use strict";s.d(t,{h:()=>r});let r=s(4099).Z.create({baseURL:process.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8000",timeout:2e4});r.interceptors.request.use(e=>e),r.interceptors.response.use(e=>e,e=>(e.response?.status===401&&(console.error("Unauthorized request detected"),localStorage.removeItem("token"),localStorage.removeItem("active_school_id"),window.location.href="/login"),Promise.reject(e)))},9366:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var r=s(2374),o=s(2366);let a=e=>e.map(e=>{let t="USER"===e.message_type?"user":"assistant";return{role:t,content:e.content,blocks:"assistant"===t&&e.response_data?.blocks?e.response_data.blocks:void 0}}),n={async sendMessage(e,t,s){let a=(0,o.rc)()??void 0;try{let{data:n}=await r.h.post("/api/chat/message",{message:e,conversation_id:t,context:s});return n.conversation_id&&(t?o.MN.messageSent(n.conversation_id,{message:e,response:n.response},a):o.MN.conversationCreated(n.conversation_id,{title:e.slice(0,50)},a)),n}catch(e){throw console.error("Failed to send message:",e),e}},async getSuggestions(){let{data:e}=await r.h.get("/api/chat/suggestions");return e},async getConversations(e=1,t=20,s=!1){try{let{data:o}=await r.h.get("/api/chat/conversations",{params:{page:e,limit:t,include_archived:s}});return o}catch(e){throw console.error("Failed to get conversations:",e),e}},async getConversation(e){try{let{data:t}=await r.h.get(`/api/chat/conversations/${e}`),s=a(t.messages||[]);return{...t,displayMessages:s}}catch(e){throw console.error("Failed to get conversation:",e),e}},async updateConversation(e,t){let s=(0,o.rc)()??void 0;try{let{data:a}=await r.h.patch(`/api/chat/conversations/${e}`,t);return o.MN.conversationUpdated(e,t,s),a}catch(e){throw console.error("Failed to update conversation:",e),e}},async deleteConversation(e){let t=(0,o.rc)()??void 0;try{await r.h.delete(`/api/chat/conversations/${e}`),o.MN.conversationDeleted(e,t)}catch(e){throw console.error("Failed to delete conversation:",e),e}},async getRecentConversations(e=7,t=10){try{let{data:s}=await r.h.get("/api/chat/conversations/recent",{params:{days:e,limit:t}});return s}catch(e){throw console.error("Failed to get recent conversations:",e),e}},async searchConversations(e,t=20){try{let{data:s}=await r.h.get("/api/chat/conversations/search",{params:{q:e,limit:t}});return s}catch(e){throw console.error("Failed to search conversations:",e),e}},forceRefresh(){let e=(0,o.rc)()??void 0;o.MN.forceRefresh(e)},async list(){return(await this.getConversations(1,50)).conversations.map(e=>({id:e.id,title:e.title,is_starred:!1,created_at:e.created_at,updated_at:e.last_activity}))},async get(e){let t=await this.getConversation(e);return{chat:{id:t.id,title:t.title,is_starred:!1},messages:t.displayMessages}},create:async()=>({id:"new",title:"New Chat",messages:[]}),async update(e,t){return t.title&&await this.updateConversation(e,{title:t.title}),{id:e,...t}},async delete(e){await this.deleteConversation(e)},star:async e=>(console.warn("Starring not implemented on backend yet"),{id:e,is_starred:!0}),unstar:async e=>(console.warn("Unstarring not implemented on backend yet"),{id:e,is_starred:!1}),async rename(e,t){return await this.updateConversation(e,{title:t})}}},2366:(e,t,s)=>{"use strict";s.d(t,{MN:()=>o,rc:()=>a}),s(7577);class r{constructor(){this.listeners=new Map,this.lastEventTimestamp=0,this.handleStorageEvent=e=>{if("chat_event"===e.key&&e.newValue)try{let t=JSON.parse(e.newValue);if(t.timestamp<=this.lastEventTimestamp)return;this.lastEventTimestamp=t.timestamp,this.notifyListeners(t)}catch(e){console.error("Error parsing chat event:",e)}},this.handleWindowFocus=()=>{this.broadcast("force_refresh")},this.handleVisibilityChange=()=>{document.hidden||this.broadcast("force_refresh")}}notifyListeners(e){let t=this.listeners.get(e.type)||[],s=this.listeners.get("*")||[];t.concat(s).forEach(t=>{try{t(e)}catch(e){console.error("Error in chat event listener:",e)}})}subscribe(e,t){return this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(t),()=>{let s=this.listeners.get(e)||[],r=s.indexOf(t);r>-1&&s.splice(r,1)}}broadcast(e,t,s,r){}conversationCreated(e,t,s){this.broadcast("conversation_created",e,t,s)}conversationUpdated(e,t,s){this.broadcast("conversation_updated",e,t,s)}conversationDeleted(e,t){this.broadcast("conversation_deleted",e,void 0,t)}messageSent(e,t,s){this.broadcast("message_sent",e,t,s)}forceRefresh(e){this.broadcast("force_refresh",void 0,void 0,e)}destroy(){this.listeners.clear()}}let o=new r;function a(){return null}},7449:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d,metadata:()=>l});var r=s(9510);s(7272),s(1159);var o=s(8570);let a=(0,o.createProxy)(String.raw`/Users/ericmwirichia/Documents/SchoolAI/doneFrontend/contexts/AuthContext.tsx`),{__esModule:n,$$typeof:i}=a;a.default;let c=(0,o.createProxy)(String.raw`/Users/ericmwirichia/Documents/SchoolAI/doneFrontend/contexts/AuthContext.tsx#AuthProvider`);(0,o.createProxy)(String.raw`/Users/ericmwirichia/Documents/SchoolAI/doneFrontend/contexts/AuthContext.tsx#useAuth`);let l={title:"School Chat Alpha"};function d({children:e}){return r.jsx("html",{lang:"en",children:r.jsx("body",{className:"min-h-svh bg-neutral-50 text-neutral-900 dark:bg-neutral-950 dark:text-neutral-100 antialiased",children:r.jsx(c,{children:e})})})}},7272:()=>{}};