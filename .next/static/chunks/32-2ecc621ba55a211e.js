"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[32],{4308:function(e,t,r){r.d(t,{Z:function(){return s}});var a=r(7437),n=r(4839);function s(e){let{className:t,children:r,...s}=e;return(0,a.jsx)("button",{className:(0,n.Z)("btn-primary",t),...s,children:r})}},1702:function(e,t,r){r.d(t,{Z:function(){return c}});var a=r(7437),n=r(2265),s=r(4817),o=r(518);let l=(0,r(8030).Z)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);var i=r(4308);function c(e){let{data:t,columns:r,actions:c,loading:u=!1,searchable:d=!1,searchPlaceholder:h="Search...",pagination:m,emptyMessage:g="No data available",className:p=""}=e,[v,f]=(0,n.useState)(""),[_,x]=(0,n.useState)(null),k=d?t.filter(e=>Object.values(e).some(e=>String(e).toLowerCase().includes(v.toLowerCase()))):t,b=_?[...k].sort((e,t)=>{let r=e[_.key],a=t[_.key];return r<a?"asc"===_.direction?-1:1:r>a?"asc"===_.direction?1:-1:0}):k,y=e=>{x(t=>(null==t?void 0:t.key)===e?{key:e,direction:"asc"===t.direction?"desc":"asc"}:{key:e,direction:"asc"})},w=(e,t)=>{let r=e[t.key];return t.render?t.render(r,e):r};return u?(0,a.jsx)("div",{className:"card ".concat(p),children:(0,a.jsxs)("div",{className:"p-8 text-center",children:[(0,a.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-[--color-brand]"}),(0,a.jsx)("p",{className:"mt-2 text-neutral-600",children:"Loading..."})]})}):(0,a.jsxs)("div",{className:"card ".concat(p),children:[d&&(0,a.jsx)("div",{className:"p-4 border-b border-neutral-200 dark:border-neutral-700",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(s.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-neutral-400",size:16}),(0,a.jsx)("input",{type:"text",placeholder:h,value:v,onChange:e=>f(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-neutral-300 dark:border-neutral-600 rounded-lg  bg-white dark:bg-neutral-800 focus:ring-2 focus:ring-[--color-brand] focus:border-transparent"})]})}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-neutral-50 dark:bg-neutral-800",children:(0,a.jsxs)("tr",{children:[r.map((e,t)=>(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-neutral-500 dark:text-neutral-400 uppercase tracking-wider\n                    ".concat(e.sortable?"cursor-pointer hover:bg-neutral-100 dark:hover:bg-neutral-700":"","\n                    ").concat(e.width?"w-".concat(e.width):""),onClick:e.sortable?()=>y(String(e.key)):void 0,children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[e.label,e.sortable&&(null==_?void 0:_.key)===e.key&&(0,a.jsx)("span",{className:"text-[--color-brand]",children:"asc"===_.direction?"↑":"↓"})]})},t)),c&&c.length>0&&(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-neutral-500 dark:text-neutral-400 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-neutral-200 dark:divide-neutral-700",children:0===b.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:r.length+(c?1:0),className:"px-4 py-8 text-center text-neutral-500 dark:text-neutral-400",children:g})}):b.map((e,t)=>(0,a.jsxs)("tr",{className:"hover:bg-neutral-50 dark:hover:bg-neutral-800/50",children:[r.map((t,r)=>(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-neutral-900 dark:text-neutral-100",children:w(e,t)},r)),c&&c.length>0&&(0,a.jsx)("td",{className:"px-4 py-3 text-sm",children:(0,a.jsx)("div",{className:"flex gap-2",children:c.map((t,r)=>{var n;return(0,a.jsxs)(i.Z,{onClick:()=>t.onClick(e),className:"btn-sm ".concat("danger"===t.variant?"btn-danger":"secondary"===t.variant?"btn-secondary":"btn-primary"),disabled:null===(n=t.disabled)||void 0===n?void 0:n.call(t,e),children:[t.icon&&(0,a.jsx)("span",{className:"mr-1",children:t.icon}),t.label]},r)})})})]},t))})]})}),m&&(0,a.jsxs)("div",{className:"px-4 py-3 border-t border-neutral-200 dark:border-neutral-700 flex items-center justify-between",children:[(0,a.jsxs)("p",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:["Page ",m.currentPage," of ",m.totalPages]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(i.Z,{onClick:()=>m.onPageChange(m.currentPage-1),disabled:m.currentPage<=1,className:"btn-sm btn-secondary",children:[(0,a.jsx)(o.Z,{size:16}),"Previous"]}),(0,a.jsxs)(i.Z,{onClick:()=>m.onPageChange(m.currentPage+1),disabled:m.currentPage>=m.totalPages,className:"btn-sm btn-secondary",children:["Next",(0,a.jsx)(l,{size:16})]})]})]})]})}},857:function(e,t,r){r.d(t,{AuthProvider:function(){return i},a:function(){return c}});var a=r(7437),n=r(2265),s=r(6463),o=r(1785);let l=(0,n.createContext)({token:null,active_school_id:null,user:null,isLoading:!0,login:async()=>{},logout:()=>{},setSchoolId:()=>{},isAuthenticated:!1});function i(e){let{children:t}=e,[r,i]=(0,n.useState)({token:null,active_school_id:null,user:null,isLoading:!0}),c=(0,s.useRouter)();(0,n.useEffect)(()=>{(async()=>{let e=localStorage.getItem("token"),t=localStorage.getItem("active_school_id");if(e){o.O.storeToken(e);try{let r=await o.O.getCurrentUser();i({token:e,active_school_id:t,user:r,isLoading:!1})}catch(e){console.error("Failed to fetch user data:",e),localStorage.removeItem("token"),localStorage.removeItem("active_school_id"),i({token:null,active_school_id:null,user:null,isLoading:!1})}}else i({token:null,active_school_id:null,user:null,isLoading:!1})})()},[]);let u=async e=>{localStorage.setItem("token",e.token),o.O.storeToken(e.token);try{var t,r,a;let n=await o.O.getCurrentUser();i(t=>({...t,token:e.token,user:n,isLoading:!1})),(null===(t=n.roles)||void 0===t?void 0:t.includes("TESTER"))?c.replace("/tester"):(null===(r=n.permissions)||void 0===r?void 0:r.is_admin)||(null===(a=n.permissions)||void 0===a?void 0:a.is_super_admin)?c.replace("/admin"):c.replace("/dashboard")}catch(t){throw console.error("Failed to fetch user data after login:",t),i(t=>({...t,token:e.token,user:null,isLoading:!1})),t}},d={...r,login:u,logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("active_school_id"),o.O.logout(),i({token:null,active_school_id:null,user:null,isLoading:!1}),c.replace("/login")},setSchoolId:e=>{localStorage.setItem("active_school_id",e),o.O.storeSchoolId(e),i(t=>({...t,active_school_id:e}))},isAuthenticated:!!r.token&&!!r.user&&!r.isLoading};return(0,a.jsx)(l.Provider,{value:d,children:t})}let c=()=>(0,n.useContext)(l)},8030:function(e,t,r){r.d(t,{Z:function(){return d}});var a=r(2265);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),s=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),o=e=>{let t=s(e);return t.charAt(0).toUpperCase()+t.slice(1)},l=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()},i=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let u=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:n=24,strokeWidth:s=2,absoluteStrokeWidth:o,className:u="",children:d,iconNode:h,...m}=e;return(0,a.createElement)("svg",{ref:t,...c,width:n,height:n,stroke:r,strokeWidth:o?24*Number(s)/Number(n):s,className:l("lucide",u),...!d&&!i(m)&&{"aria-hidden":"true"},...m},[...h.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),d=(e,t)=>{let r=(0,a.forwardRef)((r,s)=>{let{className:i,...c}=r;return(0,a.createElement)(u,{ref:s,iconNode:t,className:l("lucide-".concat(n(o(e))),"lucide-".concat(e),i),...c})});return r.displayName=o(e),r}},518:function(e,t,r){r.d(t,{Z:function(){return a}});let a=(0,r(8030).Z)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},4817:function(e,t,r){r.d(t,{Z:function(){return a}});let a=(0,r(8030).Z)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},459:function(e,t,r){r.d(t,{x:function(){return o}});var a=r(8472),n=r(357);class s{handleApiError(e){if(console.error("❌ API Error:",e),e.response){let t=e.response.status,r=e.response.data;switch(t){case 401:localStorage.removeItem("token"),localStorage.removeItem("active_school_id"),window.location.pathname.includes("/login")||window.location.pathname.includes("/signup")||window.location.pathname.includes("/public")||(window.location.href="/login");break;case 403:console.warn("⚠️ Access forbidden:",(null==r?void 0:r.detail)||"Insufficient permissions");break;case 404:console.warn("⚠️ Resource not found:",(null==r?void 0:r.detail)||"Resource not found");break;case 422:console.warn("⚠️ Validation error:",(null==r?void 0:r.detail)||"Invalid request data");break;case 500:console.error("\uD83D\uDCA5 Server error:",(null==r?void 0:r.detail)||"Internal server error");break;default:console.error("\uD83D\uDCA5 HTTP ".concat(t,":"),(null==r?void 0:r.detail)||e.message)}}else e.request?console.error("\uD83C\uDF10 Network error - no response received:",e.message):console.error("⚙️ Request setup error:",e.message)}async get(e,t){return this.client.get(e,{params:t})}async post(e,t){return this.client.post(e,t)}async put(e,t){return this.client.put(e,t)}async patch(e,t){return this.client.patch(e,t)}async delete(e){return this.client.delete(e)}async uploadFile(e,t,r){let a=new FormData;return a.append("file",t),r&&Object.keys(r).forEach(e=>{a.append(e,r[e])}),this.client.post(e,a,{headers:{"Content-Type":"multipart/form-data"}})}async healthCheck(){try{let e=await this.client.get("/healthz");return 200===e.status}catch(e){return console.error("Health check failed:",e),!1}}getBaseURL(){return this.baseURL}setAuthToken(e){this.client.defaults.headers.common.Authorization="Bearer ".concat(e)}clearAuthToken(){delete this.client.defaults.headers.common.Authorization}static isSuccess(e){return e.status>=200&&e.status<300}static getErrorMessage(e){var t;if(null===(t=e.response)||void 0===t?void 0:t.data){let t=e.response.data;return t.detail||t.message||"An error occurred"}return e.message||"Network error"}constructor(){this.baseURL=n.env.NEXT_PUBLIC_API_URL||"http://localhost:8000",this.client=a.Z.create({baseURL:this.baseURL,timeout:3e4,headers:{"Content-Type":"application/json"}}),this.client.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>(console.error("❌ Request interceptor error:",e),Promise.reject(e))),this.client.interceptors.response.use(e=>e,e=>(this.handleApiError(e),Promise.reject(e)))}}let o=new s},1785:function(e,t,r){r.d(t,{O:function(){return s}});var a=r(459);class n{async login(e){return(await a.x.post("/api/auth/login",e)).data}async register(e){return(await a.x.post("/api/auth/register",e)).data}async switchSchool(e){return(await a.x.post("/api/auth/switch-school",e)).data}async getCurrentUser(){return(await a.x.get("/api/auth/me")).data}async getUserPermissions(){return(await a.x.get("/api/auth/permissions")).data}hasRole(e,t){var r,a;return null!==(a=null==e?void 0:null===(r=e.roles)||void 0===r?void 0:r.includes(t))&&void 0!==a&&a}hasAnyRole(e,t){return null!=e&&!!e.roles&&t.some(t=>e.roles.includes(t))}isAdmin(e){return this.hasAnyRole(e,["ADMIN","SUPER_ADMIN"])}isSuperAdmin(e){return this.hasRole(e,"SUPER_ADMIN")}isTester(e){return this.hasRole(e,"TESTER")}getPrimaryRole(e){var t;return null!==(t=null==e?void 0:e.primary_role)&&void 0!==t?t:"PARENT"}formatRoleName(e){return({SUPER_ADMIN:"Super Admin",ADMIN:"Administrator",TESTER:"Tester",TEACHER:"Teacher",ACCOUNTANT:"Accountant",PARENT:"Parent"})[e]||e}getAvailableActions(e){let t=[];return e&&(e.can_manage_students&&t.push("manage_students"),e.can_manage_classes&&t.push("manage_classes"),e.can_manage_fees&&t.push("manage_fees"),e.can_manage_payments&&t.push("manage_payments"),e.can_manage_school&&t.push("manage_school"),e.can_manage_users&&t.push("manage_users"),e.can_view_logs&&t.push("view_logs"),e.can_manage_intent_config&&t.push("manage_intent_config"),e.can_access_tester_queue&&t.push("access_tester_queue"),e.can_submit_suggestions&&t.push("submit_suggestions"),e.can_manage_all_schools&&t.push("manage_all_schools"),e.can_access_system_settings&&t.push("access_system_settings")),t}logout(){localStorage.removeItem("token"),localStorage.removeItem("active_school_id")}getStoredToken(){return localStorage.getItem("token")}getStoredSchoolId(){return localStorage.getItem("active_school_id")}storeToken(e){localStorage.setItem("token",e)}storeSchoolId(e){localStorage.setItem("active_school_id",e)}}let s=new n},4839:function(e,t,r){function a(){for(var e,t,r=0,a="",n=arguments.length;r<n;r++)(e=arguments[r])&&(t=function e(t){var r,a,n="";if("string"==typeof t||"number"==typeof t)n+=t;else if("object"==typeof t){if(Array.isArray(t)){var s=t.length;for(r=0;r<s;r++)t[r]&&(a=e(t[r]))&&(n&&(n+=" "),n+=a)}else for(a in t)t[a]&&(n&&(n+=" "),n+=a)}return n}(e))&&(a&&(a+=" "),a+=t);return a}r.d(t,{W:function(){return a}}),t.Z=a}}]);