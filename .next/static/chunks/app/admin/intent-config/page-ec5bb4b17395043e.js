(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[884],{5383:function(e,t,a){Promise.resolve().then(a.bind(a,935))},935:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return h}});var n=a(7437),s=a(2265),i=a(857),r=a(9541),l=a(1702),c=a(6649),o=a(8094);let d=(0,a(8030).Z)("archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);var m=a(4697),x=a(6706),p=a(2513),u=a(497),g=a(4308);function h(){var e,t,a;let{user:u}=(0,i.a)(),[h,y]=(0,s.useState)([]),[b,v]=(0,s.useState)(null),[j,w]=(0,s.useState)([]),[k,N]=(0,s.useState)([]),[_,C]=(0,s.useState)(!0),[S,Z]=(0,s.useState)("versions"),[P,D]=(0,s.useState)(null),[M,T]=(0,s.useState)(null),[A,z]=(0,s.useState)(!1),[q,V]=(0,s.useState)(!1),[F,E]=(0,s.useState)(!1);(0,s.useEffect)(()=>{L()},[]),(0,s.useEffect)(()=>{b&&"patterns"===S&&R(b.id),b&&"templates"===S&&I(b.id)},[b,S]);let L=async()=>{try{C(!0);let e=await r.q.getVersions();y(e);let t=e.find(e=>"active"===e.status);t&&v(t)}catch(e){console.error("Failed to load versions:",e)}finally{C(!1)}},R=async e=>{try{let t=await r.q.getPatterns(e);w(t)}catch(e){console.error("Failed to load patterns:",e)}},I=async e=>{try{let t=await r.q.getTemplates(e);N(t)}catch(e){console.error("Failed to load templates:",e)}},O=async e=>{if(confirm('Are you sure you want to promote "'.concat(e.name,'" to active?')))try{await r.q.promoteVersion(e.id),L()}catch(e){console.error("Failed to promote version:",e)}},H=async e=>{if(confirm('Are you sure you want to archive "'.concat(e.name,'"?')))try{await r.q.archiveVersion(e.id),L()}catch(e){console.error("Failed to archive version:",e)}},U=async()=>{try{await r.q.reloadConfig(),alert("Configuration cache reloaded successfully")}catch(e){console.error("Failed to reload config:",e),alert("Failed to reload configuration")}},J=[{label:"Select",icon:(0,n.jsx)(c.Z,{size:14}),onClick:e=>v(e),variant:"secondary"},{label:"Promote",icon:(0,n.jsx)(o.Z,{size:14}),onClick:O,variant:"primary",disabled:e=>"active"===e.status},{label:"Archive",icon:(0,n.jsx)(d,{size:14}),onClick:H,variant:"danger",disabled:e=>"active"===e.status}],K=[{label:"Edit",icon:(0,n.jsx)(c.Z,{size:14}),onClick:e=>D(e),variant:"secondary"},{label:"Delete",icon:(0,n.jsx)(m.Z,{size:14}),onClick:async e=>{if(confirm("Are you sure you want to delete this pattern?"))try{await r.q.deletePattern(e.id),b&&R(b.id)}catch(e){console.error("Failed to delete pattern:",e)}},variant:"danger"}];return(null==u?void 0:null===(e=u.permissions)||void 0===e?void 0:e.can_manage_intent_config)||(null==u?void 0:null===(t=u.permissions)||void 0===t?void 0:t.is_admin)||(null==u?void 0:null===(a=u.permissions)||void 0===a?void 0:a.is_super_admin)?(0,n.jsxs)("div",{className:"p-4 sm:p-6",children:[(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 sm:mb-6 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-xl sm:text-2xl font-bold mb-2",children:"Intent Configuration"}),(0,n.jsx)("p",{className:"text-sm sm:text-base text-neutral-600",children:"Manage AI intent patterns and response templates"})]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsxs)(g.Z,{onClick:U,className:"btn-secondary flex items-center gap-2 text-sm",children:[(0,n.jsx)(x.Z,{size:16}),(0,n.jsx)("span",{className:"hidden sm:inline",children:"Reload Cache"}),(0,n.jsx)("span",{className:"sm:hidden",children:"Reload"})]}),(0,n.jsxs)(g.Z,{onClick:()=>z(!0),className:"flex items-center gap-2 text-sm",children:[(0,n.jsx)(p.Z,{size:16}),(0,n.jsx)("span",{className:"hidden sm:inline",children:"New Version"}),(0,n.jsx)("span",{className:"sm:hidden",children:"New"})]})]})]}),(0,n.jsx)("div",{className:"border-b border-neutral-200 dark:border-neutral-700 mb-4 sm:mb-6",children:(0,n.jsx)("nav",{className:"flex space-x-4 sm:space-x-8 overflow-x-auto",children:["versions","patterns","templates","logs","test"].map(e=>(0,n.jsx)("button",{onClick:()=>Z(e),className:"py-2 px-1 border-b-2 font-medium text-xs sm:text-sm whitespace-nowrap ".concat(S===e?"border-[--color-brand] text-[--color-brand]":"border-transparent text-neutral-500 hover:text-neutral-700 dark:hover:text-neutral-300"),children:e.charAt(0).toUpperCase()+e.slice(1)},e))})}),b&&"versions"!==S&&(0,n.jsx)("div",{className:"card p-3 sm:p-4 mb-4 sm:mb-6",children:(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("h3",{className:"font-semibold text-sm sm:text-base",children:["Working with: ",b.name]}),(0,n.jsxs)("p",{className:"text-xs sm:text-sm text-neutral-600",children:["Status: ",b.status," |",b.pattern_count," patterns, ",b.template_count," templates"]})]}),(0,n.jsx)(g.Z,{onClick:()=>Z("versions"),className:"btn-secondary text-sm",children:"Change Version"})]})}),"versions"===S&&(0,n.jsx)(l.Z,{data:h,columns:[{key:"name",label:"Name",sortable:!0},{key:"status",label:"Status",render:e=>(0,n.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("active"===e?"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-200":"candidate"===e?"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200":"bg-gray-100 dark:bg-gray-900/30 text-gray-800 dark:text-gray-200"),children:e.toUpperCase()})},{key:"pattern_count",label:"Patterns",render:e=>e.toString()},{key:"template_count",label:"Templates",render:e=>e.toString()},{key:"created_at",label:"Created",render:e=>new Date(e).toLocaleDateString()}],actions:J,loading:_,searchable:!0,searchPlaceholder:"Search versions...",emptyMessage:"No configuration versions found"}),"patterns"===S&&b&&(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 gap-3",children:[(0,n.jsx)("h3",{className:"text-base sm:text-lg font-semibold",children:"Patterns"}),(0,n.jsxs)(g.Z,{onClick:()=>V(!0),className:"flex items-center gap-2 text-sm",children:[(0,n.jsx)(p.Z,{size:16}),"Add Pattern"]})]}),(0,n.jsx)(l.Z,{data:j,columns:[{key:"handler",label:"Handler",render:e=>(0,n.jsx)("code",{className:"text-xs sm:text-sm bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded",children:e})},{key:"intent",label:"Intent"},{key:"kind",label:"Kind",render:e=>(0,n.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs ".concat("positive"===e?"bg-green-100 text-green-800":"negative"===e?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"),children:e})},{key:"pattern",label:"Pattern",render:e=>(0,n.jsx)("code",{className:"text-xs max-w-xs truncate block",children:e})},{key:"priority",label:"Priority"},{key:"enabled",label:"Enabled",render:e=>e?"✅":"❌"}],actions:K,loading:_,searchable:!0,searchPlaceholder:"Search patterns...",emptyMessage:"No patterns found"})]}),"templates"===S&&b&&(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 gap-3",children:[(0,n.jsx)("h3",{className:"text-base sm:text-lg font-semibold",children:"Templates"}),(0,n.jsxs)(g.Z,{onClick:()=>E(!0),className:"flex items-center gap-2 text-sm",children:[(0,n.jsx)(p.Z,{size:16}),"Add Template"]})]}),(0,n.jsx)(l.Z,{data:k,columns:[{key:"handler",label:"Handler",render:e=>(0,n.jsx)("code",{className:"text-xs sm:text-sm bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded",children:e})},{key:"intent",label:"Intent",render:e=>e||"-"},{key:"template_type",label:"Type",render:e=>(0,n.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-purple-100 text-purple-800",children:e})},{key:"template_text",label:"Template",render:e=>(0,n.jsx)("div",{className:"max-w-xs sm:max-w-md truncate text-xs sm:text-sm",children:e})},{key:"enabled",label:"Enabled",render:e=>e?"✅":"❌"}],actions:[{label:"Edit",icon:(0,n.jsx)(c.Z,{size:14}),onClick:e=>T(e),variant:"secondary"},{label:"Delete",icon:(0,n.jsx)(m.Z,{size:14}),onClick:async e=>{if(confirm("Are you sure you want to delete this template?"))try{await r.q.deleteTemplate(e.id),b&&I(b.id)}catch(e){console.error("Failed to delete template:",e)}},variant:"danger"}],loading:_,searchable:!0,searchPlaceholder:"Search templates...",emptyMessage:"No templates found"})]}),"logs"===S&&(0,n.jsxs)("div",{className:"card p-4 sm:p-6",children:[(0,n.jsx)("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:"Routing Logs"}),(0,n.jsx)("p",{className:"text-sm sm:text-base text-neutral-600 mb-3 sm:mb-4",children:"View routing logs and analytics in the Logs section."}),(0,n.jsx)(g.Z,{onClick:()=>window.location.href="/admin/logs",className:"text-sm",children:"View Logs"})]}),"test"===S&&(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-base sm:text-lg font-semibold mb-4",children:"Test Classification"}),(0,n.jsx)(f,{})]})]}):(0,n.jsx)("div",{className:"p-4 sm:p-6",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("h1",{className:"text-xl sm:text-2xl font-bold mb-4",children:"Access Denied"}),(0,n.jsx)("p",{className:"text-neutral-600",children:"You don't have permission to manage intent configuration."})]})})}function f(){let[e,t]=(0,s.useState)(""),[a,i]=(0,s.useState)(null),[l,c]=(0,s.useState)(!1),o=async()=>{if(e.trim())try{c(!0);let t=await r.q.testClassify({message:e});i(t)}catch(e){console.error("Test failed:",e)}finally{c(!1)}};return(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"label text-sm",children:"Test Message"}),(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,n.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"Enter a message to test classification...",className:"input flex-1 text-sm"}),(0,n.jsxs)(g.Z,{onClick:o,disabled:l||!e.trim(),className:"flex items-center gap-2 text-sm",children:[(0,n.jsx)(u.Z,{size:16}),l?"Testing...":"Test"]})]})]}),a&&(0,n.jsxs)("div",{className:"card p-3 sm:p-4",children:[(0,n.jsx)("h4",{className:"font-semibold mb-3 text-sm sm:text-base",children:"Classification Result"}),(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{className:"text-sm",children:"Final Decision:"}),(0,n.jsx)("pre",{className:"mt-1 p-2 bg-gray-100 dark:bg-gray-800 rounded text-xs sm:text-sm overflow-auto",children:JSON.stringify(a.final_decision,null,2)})]}),a.config_router_result&&(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{className:"text-sm",children:"Config Router:"}),(0,n.jsx)("pre",{className:"mt-1 p-2 bg-blue-50 dark:bg-blue-900/20 rounded text-xs sm:text-sm overflow-auto",children:JSON.stringify(a.config_router_result,null,2)})]}),a.llm_classifier_result&&(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{className:"text-sm",children:"LLM Classifier:"}),(0,n.jsx)("pre",{className:"mt-1 p-2 bg-green-50 dark:bg-green-900/20 rounded text-xs sm:text-sm overflow-auto",children:JSON.stringify(a.llm_classifier_result,null,2)})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{className:"text-sm",children:"Processing Steps:"}),(0,n.jsx)("ul",{className:"mt-1 space-y-1",children:a.processing_steps.map((e,t)=>(0,n.jsxs)("li",{className:"text-xs sm:text-sm text-neutral-600",children:[t+1,". ",e]},t))})]})]})]})]})}},8094:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});let n=(0,a(8030).Z)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]])},2513:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});let n=(0,a(8030).Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},6706:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});let n=(0,a(8030).Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},6649:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});let n=(0,a(8030).Z)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},497:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});let n=(0,a(8030).Z)("test-tube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]])},4697:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});let n=(0,a(8030).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},9541:function(e,t,a){"use strict";a.d(t,{q:function(){return i}});var n=a(459);class s{async getConfigurationOverview(){return(await n.x.get("/api/admin/configuration/overview")).data}async getCacheStats(){return(await n.x.get("/api/admin/configuration/cache/stats")).data}async reloadCache(){return(await n.x.post("/api/admin/configuration/cache/reload")).data}async getVersions(){return(await n.x.get("/api/admin/intent-config/versions")).data}async createVersion(e){return(await n.x.post("/api/admin/intent-config/versions",e)).data}async promoteVersion(e){return(await n.x.post("/api/admin/intent-config/versions/".concat(e,"/promote"))).data}async archiveVersion(e){return(await n.x.post("/api/admin/intent-config/versions/".concat(e,"/archive"))).data}async getPatterns(e,t){let a=new URLSearchParams;return(null==t?void 0:t.handler)&&a.append("handler",t.handler),(null==t?void 0:t.intent)&&a.append("intent",t.intent),(null==t?void 0:t.kind)&&a.append("kind",t.kind),(await n.x.get("/api/admin/intent-config/versions/".concat(e,"/patterns?").concat(a.toString()))).data}async createPattern(e,t){return(await n.x.post("/api/admin/intent-config/versions/".concat(e,"/patterns"),t)).data}async updatePattern(e,t){return(await n.x.put("/api/admin/intent-config/patterns/".concat(e),t)).data}async deletePattern(e){return(await n.x.delete("/api/admin/intent-config/patterns/".concat(e))).data}async enablePattern(e){return(await n.x.post("/api/admin/intent-config/patterns/".concat(e,"/enable"))).data}async testPatternWithPhrases(e,t){return(await n.x.post("/api/admin/intent-config/patterns/".concat(e,"/test-phrases"),t)).data}async improvePattern(e,t,a){return(await n.x.post("/api/admin/intent-config/patterns/".concat(e,"/improve"),{missed_phrases:t,false_positives:a})).data}async testPattern(e,t){return(await n.x.post("/api/admin/intent-config/patterns/".concat(e,"/test"),{test_message:t})).data}async getTemplates(e,t){let a=new URLSearchParams;return(null==t?void 0:t.handler)&&a.append("handler",t.handler),(null==t?void 0:t.template_type)&&a.append("template_type",t.template_type),(await n.x.get("/api/admin/intent-config/versions/".concat(e,"/templates?").concat(a.toString()))).data}async createTemplate(e,t){return(await n.x.post("/api/admin/intent-config/versions/".concat(e,"/templates"),t)).data}async updateTemplate(e,t){return(await n.x.put("/api/admin/intent-config/templates/".concat(e),t)).data}async deleteTemplate(e){return(await n.x.delete("/api/admin/intent-config/templates/".concat(e))).data}async enableTemplate(e){return(await n.x.post("/api/admin/intent-config/templates/".concat(e,"/enable"))).data}async testClassify(e){return(await n.x.post("/api/admin/intent-config/test-classify",e)).data}async reloadConfig(){return(await n.x.post("/api/admin/intent-config/reload")).data}async getStats(){return(await n.x.get("/api/admin/intent-config/stats")).data}async getAvailableHandlers(){return(await n.x.get("/api/admin/intent-config/handlers")).data}async getAvailableIntents(e){return(await n.x.get("/api/admin/intent-config/intents".concat(e?"?handler=".concat(e):""))).data}async getPatternKinds(){return(await n.x.get("/api/admin/intent-config/pattern-kinds")).data}async getTemplateTypes(){return(await n.x.get("/api/admin/intent-config/template-types")).data}async generateRegexFromPhrases(e){console.log("\uD83D\uDD0D Sending regex generation request:",e);try{let t=await n.x.post("/api/admin/intent-config/generate-regex",e);console.log("\uD83D\uDD0D Raw API response:",t.data);let a={phrases:t.data.phrases||e.phrases,intent:t.data.intent||e.intent,pattern_kind:t.data.pattern_kind||e.pattern_kind||"positive",generated_regex:t.data.generated_regex||t.data.regex||"",confidence:t.data.confidence||0,explanation:t.data.explanation||"",test_matches:t.data.test_matches||[],errors:t.data.errors||[]};return console.log("\uD83D\uDD0D Processed regex generation response:",a),a}catch(e){throw console.error("❌ Regex generation API error:",e),e}}async exportConfiguration(e,t){return(await n.x.get("/api/admin/intent-config/versions/".concat(e,"/export?format=").concat(t),{responseType:"blob"})).data}async validateConfiguration(e){return(await n.x.post("/api/admin/intent-config/versions/".concat(e,"/validate"))).data}}let i=new s}},function(e){e.O(0,[236,32,971,23,744],function(){return e(e.s=5383)}),_N_E=e.O()}]);