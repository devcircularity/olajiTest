(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[910],{8054:function(e,t,s){Promise.resolve().then(s.bind(s,3190))},3190:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return p}});var a=s(7437),r=s(2265),n=s(857),l=s(3299),i=s(7390),o=s(8030);let c=(0,o.Z)("trending-down",[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]]);var d=s(4207),m=s(6127);let x=(0,o.Z)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);var u=s(3225),g=s(4308);function p(){var e,t,s;let{user:o}=(0,n.a)(),[p,h]=(0,r.useState)(null),[f,b]=(0,r.useState)(!0),[_,y]=(0,r.useState)(7),[v,j]=(0,r.useState)([]);(0,r.useEffect)(()=>{w(),N()},[_]);let w=async()=>{try{b(!0);let e=await l.g.getStats({days_back:_});h(e)}catch(e){console.error("Failed to load stats:",e)}finally{b(!1)}},N=async()=>{let e=[];for(let t=_;t>=0;t--){let s=new Date;s.setDate(s.getDate()-t),e.push({date:s.toLocaleDateString(),negative_ratings:Math.floor(10*Math.random())+1,fallback_used:Math.floor(15*Math.random())+2,low_confidence:Math.floor(20*Math.random())+5,total_messages:Math.floor(100*Math.random())+50})}j(e)},k=(e,t)=>t>0?(e/t*100).toFixed(1):"0.0",S=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t?e<5?"text-green-600":e<10?"text-yellow-600":"text-red-600":e<5?"text-green-600":e<15?"text-yellow-600":"text-red-600"};return(null==o?void 0:null===(e=o.permissions)||void 0===e?void 0:e.is_tester)||(null==o?void 0:null===(t=o.permissions)||void 0===t?void 0:t.is_admin)||(null==o?void 0:null===(s=o.permissions)||void 0===s?void 0:s.is_super_admin)?(0,a.jsxs)("div",{className:"p-4 sm:p-6",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 sm:mb-6 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl sm:text-2xl font-bold mb-2",children:"Tester Analytics"}),(0,a.jsx)("p",{className:"text-sm sm:text-base text-neutral-600",children:"Detailed analytics and trends for AI response quality"})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-4",children:[(0,a.jsxs)("select",{value:_,onChange:e=>y(Number(e.target.value)),className:"input w-full sm:w-32 text-sm",children:[(0,a.jsx)("option",{value:1,children:"Last 24h"}),(0,a.jsx)("option",{value:3,children:"Last 3 days"}),(0,a.jsx)("option",{value:7,children:"Last week"}),(0,a.jsx)("option",{value:14,children:"Last 2 weeks"}),(0,a.jsx)("option",{value:30,children:"Last month"})]}),(0,a.jsx)(g.default,{onClick:w,className:"btn-secondary text-sm",children:"Refresh"})]})]}),p&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-6 mb-6 sm:mb-8",children:[(0,a.jsxs)("div",{className:"card p-4 sm:p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3 mb-3 sm:mb-4",children:[(0,a.jsx)(i.Z,{className:"text-blue-600 flex-shrink-0",size:20}),(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-neutral-900 dark:text-neutral-100",children:"Total Messages"}),(0,a.jsxs)("p",{className:"text-xs sm:text-sm text-neutral-500",children:["In ",_," days"]})]})]}),(0,a.jsx)("p",{className:"text-2xl sm:text-3xl font-bold text-blue-600 mb-2",children:p.total_messages}),(0,a.jsx)("div",{className:"text-xs sm:text-sm text-neutral-600",children:(0,a.jsxs)("span",{className:S(100,!1),children:[(p.total_messages/_).toFixed(1)," per day avg"]})})]}),(0,a.jsxs)("div",{className:"card p-4 sm:p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3 mb-3 sm:mb-4",children:[(0,a.jsx)(c,{className:"text-red-600 flex-shrink-0",size:20}),(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-neutral-900 dark:text-neutral-100",children:"Negative Feedback"}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-neutral-500",children:"User thumbs down"})]})]}),(0,a.jsx)("p",{className:"text-2xl sm:text-3xl font-bold text-red-600 mb-2",children:p.negative_ratings}),(0,a.jsx)("div",{className:"text-xs sm:text-sm",children:(0,a.jsxs)("span",{className:S(parseFloat(k(p.negative_ratings,p.total_messages)),!0),children:[k(p.negative_ratings,p.total_messages),"% of messages"]})})]}),(0,a.jsxs)("div",{className:"card p-4 sm:p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3 mb-3 sm:mb-4",children:[(0,a.jsx)(d.Z,{className:"text-orange-600 flex-shrink-0",size:20}),(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-neutral-900 dark:text-neutral-100",children:"Fallback Rate"}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-neutral-500",children:"Default responses"})]})]}),(0,a.jsx)("p",{className:"text-2xl sm:text-3xl font-bold text-orange-600 mb-2",children:p.fallback_used}),(0,a.jsx)("div",{className:"text-xs sm:text-sm",children:(0,a.jsxs)("span",{className:S(parseFloat(k(p.fallback_used,p.total_messages)),!0),children:[k(p.fallback_used,p.total_messages),"% of messages"]})})]}),(0,a.jsxs)("div",{className:"card p-4 sm:p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3 mb-3 sm:mb-4",children:[(0,a.jsx)(m.Z,{className:"text-yellow-600 flex-shrink-0",size:20}),(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-neutral-900 dark:text-neutral-100",children:"Low Confidence"}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-neutral-500",children:"Classification issues"})]})]}),(0,a.jsx)("p",{className:"text-2xl sm:text-3xl font-bold text-yellow-600 mb-2",children:p.low_confidence}),(0,a.jsx)("div",{className:"text-xs sm:text-sm",children:(0,a.jsxs)("span",{className:S(parseFloat(k(p.low_confidence,p.total_messages)),!0),children:[k(p.low_confidence,p.total_messages),"% of messages"]})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6 mb-6 sm:mb-8",children:[(0,a.jsxs)("div",{className:"card p-4 sm:p-6",children:[(0,a.jsxs)("h2",{className:"text-base sm:text-lg font-semibold mb-4 sm:mb-6 text-neutral-900 dark:text-neutral-100 flex items-center gap-2",children:[(0,a.jsx)(x,{size:18}),"Issues by Type"]}),(0,a.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center p-3 bg-red-50 dark:bg-red-900/20 rounded-lg gap-2",children:[(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsx)("span",{className:"font-medium text-red-800 dark:text-red-200 text-sm sm:text-base",children:"Negative Ratings"}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-red-600 dark:text-red-300",children:"Users gave thumbs down"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("span",{className:"text-xl sm:text-2xl font-bold text-red-600",children:p.by_issue_type.negative_rating}),(0,a.jsxs)("p",{className:"text-xs sm:text-sm text-red-600",children:[k(p.by_issue_type.negative_rating,p.needs_attention),"% of issues"]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center p-3 bg-orange-50 dark:bg-orange-900/20 rounded-lg gap-2",children:[(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsx)("span",{className:"font-medium text-orange-800 dark:text-orange-200 text-sm sm:text-base",children:"Fallback Used"}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-orange-600 dark:text-orange-300",children:"Default response triggered"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("span",{className:"text-xl sm:text-2xl font-bold text-orange-600",children:p.by_issue_type.fallback}),(0,a.jsxs)("p",{className:"text-xs sm:text-sm text-orange-600",children:[k(p.by_issue_type.fallback,p.needs_attention),"% of issues"]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg gap-2",children:[(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsx)("span",{className:"font-medium text-yellow-800 dark:text-yellow-200 text-sm sm:text-base",children:"Low Confidence"}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-yellow-600 dark:text-yellow-300",children:"Intent classification unclear"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("span",{className:"text-xl sm:text-2xl font-bold text-yellow-600",children:p.by_issue_type.low_confidence}),(0,a.jsxs)("p",{className:"text-xs sm:text-sm text-yellow-600",children:[k(p.by_issue_type.low_confidence,p.needs_attention),"% of issues"]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg gap-2",children:[(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsx)("span",{className:"font-medium text-purple-800 dark:text-purple-200 text-sm sm:text-base",children:"Unhandled"}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-purple-600 dark:text-purple-300",children:"No appropriate handler found"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("span",{className:"text-xl sm:text-2xl font-bold text-purple-600",children:p.by_issue_type.unhandled}),(0,a.jsxs)("p",{className:"text-xs sm:text-sm text-purple-600",children:[k(p.by_issue_type.unhandled,p.needs_attention),"% of issues"]})]})]})]})]}),(0,a.jsxs)("div",{className:"card p-4 sm:p-6",children:[(0,a.jsxs)("h2",{className:"text-base sm:text-lg font-semibold mb-4 sm:mb-6 text-neutral-900 dark:text-neutral-100 flex items-center gap-2",children:[(0,a.jsx)(u.Z,{size:18}),"Priority Distribution"]}),(0,a.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center p-3 bg-red-50 dark:bg-red-900/20 rounded-lg gap-2",children:[(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsx)("span",{className:"font-medium text-red-800 dark:text-red-200 text-sm sm:text-base",children:"High Priority"}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-red-600 dark:text-red-300",children:"Needs immediate attention"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("span",{className:"text-xl sm:text-2xl font-bold text-red-600",children:p.by_priority.high}),(0,a.jsxs)("p",{className:"text-xs sm:text-sm text-red-600",children:[k(p.by_priority.high,p.needs_attention),"% of queue"]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg gap-2",children:[(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsx)("span",{className:"font-medium text-yellow-800 dark:text-yellow-200 text-sm sm:text-base",children:"Medium Priority"}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-yellow-600 dark:text-yellow-300",children:"Should be addressed soon"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("span",{className:"text-xl sm:text-2xl font-bold text-yellow-600",children:p.by_priority.medium}),(0,a.jsxs)("p",{className:"text-xs sm:text-sm text-yellow-600",children:[k(p.by_priority.medium,p.needs_attention),"% of queue"]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center p-3 bg-gray-50 dark:bg-gray-900/20 rounded-lg gap-2",children:[(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsx)("span",{className:"font-medium text-gray-800 dark:text-gray-200 text-sm sm:text-base",children:"Low Priority"}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-gray-600 dark:text-gray-300",children:"Minor improvements"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("span",{className:"text-xl sm:text-2xl font-bold text-gray-600",children:p.by_priority.low}),(0,a.jsxs)("p",{className:"text-xs sm:text-sm text-gray-600",children:[k(p.by_priority.low,p.needs_attention),"% of queue"]})]})]})]}),(0,a.jsxs)("div",{className:"mt-4 sm:mt-6 p-3 sm:p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[(0,a.jsx)("h3",{className:"font-semibold text-blue-800 dark:text-blue-200 mb-2 text-sm sm:text-base",children:"System Health Score"}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(()=>{let e=Math.max(0,100-p.needs_attention/p.total_messages*200);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"text-2xl sm:text-3xl font-bold ".concat(e>=80?"text-green-600":e>=60?"text-yellow-600":"text-red-600"),children:e.toFixed(0)}),(0,a.jsx)("span",{className:"text-blue-700 dark:text-blue-300 text-sm sm:text-base",children:"/ 100"})]})})()}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-blue-700 dark:text-blue-300 mt-1",children:"Based on error rates and user feedback"})]})]})]}),(0,a.jsxs)("div",{className:"card p-4 sm:p-6 mb-6 sm:mb-8",children:[(0,a.jsx)("h2",{className:"text-base sm:text-lg font-semibold mb-4 sm:mb-6 text-neutral-900 dark:text-neutral-100",children:"Trends Over Time"}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("div",{className:"min-w-full",children:[(0,a.jsxs)("div",{className:"flex justify-between text-xs sm:text-sm font-medium text-neutral-600 dark:text-neutral-400 pb-2 border-b border-neutral-200 dark:border-neutral-700",children:[(0,a.jsx)("span",{className:"min-w-0 flex-1",children:"Date"}),(0,a.jsx)("span",{className:"min-w-0 flex-1 text-center",children:"Messages"}),(0,a.jsx)("span",{className:"min-w-0 flex-1 text-center",children:"Issues"}),(0,a.jsx)("span",{className:"min-w-0 flex-1 text-right",children:"Issue Rate"})]}),v.slice(-7).map((e,t)=>{let s=e.negative_ratings+e.fallback_used+e.low_confidence,r=s/e.total_messages*100;return(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-neutral-200 dark:border-neutral-700",children:[(0,a.jsx)("span",{className:"text-xs sm:text-sm font-medium min-w-0 flex-1",children:e.date}),(0,a.jsx)("span",{className:"text-xs sm:text-sm min-w-0 flex-1 text-center",children:e.total_messages}),(0,a.jsx)("span",{className:"text-xs sm:text-sm min-w-0 flex-1 text-center",children:s}),(0,a.jsxs)("span",{className:"text-xs sm:text-sm font-medium min-w-0 flex-1 text-right ".concat(S(r,!0)),children:[r.toFixed(1),"%"]})]},t)})]})})]}),(0,a.jsxs)("div",{className:"card p-4 sm:p-6",children:[(0,a.jsx)("h2",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4 text-neutral-900 dark:text-neutral-100",children:"Recommended Actions"}),(0,a.jsxs)("div",{className:"space-y-3",children:[p.by_priority.high>0&&(0,a.jsxs)("div",{className:"flex items-start gap-2 sm:gap-3 p-3 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[(0,a.jsx)(m.Z,{className:"text-red-600 mt-0.5 flex-shrink-0",size:16}),(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsxs)("p",{className:"font-medium text-red-800 dark:text-red-200 text-sm sm:text-base",children:[p.by_priority.high," high priority issues need attention"]}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-red-600 dark:text-red-300",children:"Review the problem queue and create suggestions for the most critical issues."})]})]}),p.by_issue_type.negative_rating/p.total_messages>.05&&(0,a.jsxs)("div",{className:"flex items-start gap-2 sm:gap-3 p-3 bg-orange-50 dark:bg-orange-900/20 rounded-lg",children:[(0,a.jsx)(c,{className:"text-orange-600 mt-0.5 flex-shrink-0",size:16}),(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsxs)("p",{className:"font-medium text-orange-800 dark:text-orange-200 text-sm sm:text-base",children:["High negative feedback rate (",k(p.by_issue_type.negative_rating,p.total_messages),"%)"]}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-orange-600 dark:text-orange-300",children:"Focus on improving response quality through better prompt templates."})]})]}),p.by_issue_type.fallback/p.total_messages>.1&&(0,a.jsxs)("div",{className:"flex items-start gap-2 sm:gap-3 p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg",children:[(0,a.jsx)(d.Z,{className:"text-yellow-600 mt-0.5 flex-shrink-0",size:16}),(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsxs)("p",{className:"font-medium text-yellow-800 dark:text-yellow-200 text-sm sm:text-base",children:["High fallback usage (",k(p.by_issue_type.fallback,p.total_messages),"%)"]}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-yellow-600 dark:text-yellow-300",children:"Consider adding more regex patterns and intent mappings."})]})]}),0===p.by_priority.high&&p.negative_ratings<5&&(0,a.jsxs)("div",{className:"flex items-start gap-2 sm:gap-3 p-3 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[(0,a.jsx)(u.Z,{className:"text-green-600 mt-0.5 flex-shrink-0",size:16}),(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsx)("p",{className:"font-medium text-green-800 dark:text-green-200 text-sm sm:text-base",children:"System is performing well"}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-green-600 dark:text-green-300",children:"Continue monitoring for new issues and opportunities for improvement."})]})]})]})]})]})]}):(0,a.jsx)("div",{className:"p-4 sm:p-6",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-xl sm:text-2xl font-bold mb-4",children:"Access Denied"}),(0,a.jsx)("p",{className:"text-neutral-600",children:"You don't have permission to view tester analytics."})]})})}},4308:function(e,t,s){"use strict";s.d(t,{default:function(){return n}});var a=s(7437),r=s(4839);function n(e){let{className:t,children:s,...n}=e;return(0,a.jsx)("button",{className:(0,r.Z)("btn-primary",t),...n,children:s})}},857:function(e,t,s){"use strict";s.d(t,{AuthProvider:function(){return o},a:function(){return c}});var a=s(7437),r=s(2265),n=s(6463),l=s(1785);let i=(0,r.createContext)({token:null,active_school_id:null,user:null,isLoading:!0,login:async()=>({}),logout:()=>{},setSchoolId:()=>{},isAuthenticated:!1,hasValidRole:!1});function o(e){var t,s,o,c;let{children:d}=e,[m,x]=(0,r.useState)({token:null,active_school_id:null,user:null,isLoading:!0}),u=(0,n.useRouter)();(0,r.useEffect)(()=>{(async()=>{let e=localStorage.getItem("token"),t=localStorage.getItem("active_school_id");if(e){l.O.storeToken(e);try{let s=await l.O.getCurrentUser();x({token:e,active_school_id:t,user:s,isLoading:!1})}catch(e){localStorage.removeItem("token"),localStorage.removeItem("active_school_id"),x({token:null,active_school_id:null,user:null,isLoading:!1})}}else x({token:null,active_school_id:null,user:null,isLoading:!1})})()},[]);let g=async e=>{localStorage.setItem("token",e.token),l.O.storeToken(e.token);try{let t=await l.O.getCurrentUser();return x(s=>({...s,token:e.token,user:t,isLoading:!1})),t}catch(t){throw x(t=>({...t,token:e.token,user:null,isLoading:!1})),t}},p=!!(t=m.user)&&!!((null===(s=t.roles)||void 0===s?void 0:s.includes("TESTER"))||(null===(o=t.permissions)||void 0===o?void 0:o.is_admin)||(null===(c=t.permissions)||void 0===c?void 0:c.is_super_admin)),h={...m,login:g,logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("active_school_id"),l.O.logout(),x({token:null,active_school_id:null,user:null,isLoading:!1}),u.replace("/login")},setSchoolId:e=>{localStorage.setItem("active_school_id",e),l.O.storeSchoolId(e),x(t=>({...t,active_school_id:e}))},isAuthenticated:!!m.token&&!!m.user&&!m.isLoading,hasValidRole:p};return(0,a.jsx)(i.Provider,{value:h,children:d})}let c=()=>(0,r.useContext)(i)},8030:function(e,t,s){"use strict";s.d(t,{Z:function(){return m}});var a=s(2265);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),l=e=>{let t=n(e);return t.charAt(0).toUpperCase()+t.slice(1)},i=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim()},o=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,a.forwardRef)((e,t)=>{let{color:s="currentColor",size:r=24,strokeWidth:n=2,absoluteStrokeWidth:l,className:d="",children:m,iconNode:x,...u}=e;return(0,a.createElement)("svg",{ref:t,...c,width:r,height:r,stroke:s,strokeWidth:l?24*Number(n)/Number(r):n,className:i("lucide",d),...!m&&!o(u)&&{"aria-hidden":"true"},...u},[...x.map(e=>{let[t,s]=e;return(0,a.createElement)(t,s)}),...Array.isArray(m)?m:[m]])}),m=(e,t)=>{let s=(0,a.forwardRef)((s,n)=>{let{className:o,...c}=s;return(0,a.createElement)(d,{ref:n,iconNode:t,className:i("lucide-".concat(r(l(e))),"lucide-".concat(e),o),...c})});return s.displayName=l(e),s}},4207:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(8030).Z)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]])},7390:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(8030).Z)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]])},3225:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(8030).Z)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]])},6127:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(8030).Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},459:function(e,t,s){"use strict";s.d(t,{x:function(){return n}});var a=s(8472);class r{handleApiError(e){!e.response||401!==e.response.status||(localStorage.removeItem("token"),localStorage.removeItem("active_school_id"),window.location.pathname.includes("/login")||window.location.pathname.includes("/signup")||window.location.pathname.includes("/public")||(window.location.href="/login"))}async get(e,t){return this.client.get(e,{params:t})}async post(e,t){return this.client.post(e,t)}async put(e,t){return this.client.put(e,t)}async patch(e,t){return this.client.patch(e,t)}async delete(e){return this.client.delete(e)}async uploadFile(e,t,s){let a=new FormData;return a.append("file",t),s&&Object.keys(s).forEach(e=>{a.append(e,s[e])}),this.client.post(e,a,{headers:{"Content-Type":"multipart/form-data"}})}async healthCheck(){try{let e=await this.client.get("/healthz");return 200===e.status}catch(e){return!1}}getBaseURL(){return this.baseURL}setAuthToken(e){this.client.defaults.headers.common.Authorization="Bearer ".concat(e)}clearAuthToken(){delete this.client.defaults.headers.common.Authorization}static isSuccess(e){return e.status>=200&&e.status<300}static getErrorMessage(e){var t;if(null===(t=e.response)||void 0===t?void 0:t.data){let t=e.response.data;return t.detail||t.message||"An error occurred"}return e.message||"Network error"}constructor(){this.baseURL="http://localhost:8000",this.client=a.Z.create({baseURL:this.baseURL,timeout:3e4,headers:{"Content-Type":"application/json"}}),this.client.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),this.client.interceptors.response.use(e=>e,e=>(this.handleApiError(e),Promise.reject(e)))}}let n=new r},1785:function(e,t,s){"use strict";s.d(t,{O:function(){return n}});var a=s(459);class r{async login(e){return(await a.x.post("/api/auth/login",e)).data}async register(e){return(await a.x.post("/api/auth/register",e)).data}async switchSchool(e){return(await a.x.post("/api/auth/switch-school",e)).data}async getCurrentUser(){return(await a.x.get("/api/auth/me")).data}async getUserPermissions(){return(await a.x.get("/api/auth/permissions")).data}hasRole(e,t){var s,a;return null!==(a=null==e?void 0:null===(s=e.roles)||void 0===s?void 0:s.includes(t))&&void 0!==a&&a}hasAnyRole(e,t){return null!=e&&!!e.roles&&t.some(t=>e.roles.includes(t))}isAdmin(e){return this.hasAnyRole(e,["ADMIN","SUPER_ADMIN"])}isSuperAdmin(e){return this.hasRole(e,"SUPER_ADMIN")}isTester(e){return this.hasRole(e,"TESTER")}getPrimaryRole(e){var t;return null!==(t=null==e?void 0:e.primary_role)&&void 0!==t?t:"PARENT"}formatRoleName(e){return({SUPER_ADMIN:"Super Admin",ADMIN:"Administrator",TESTER:"Tester",TEACHER:"Teacher",ACCOUNTANT:"Accountant",PARENT:"Parent"})[e]||e}getAvailableActions(e){let t=[];return e&&(e.can_manage_students&&t.push("manage_students"),e.can_manage_classes&&t.push("manage_classes"),e.can_manage_fees&&t.push("manage_fees"),e.can_manage_payments&&t.push("manage_payments"),e.can_manage_school&&t.push("manage_school"),e.can_manage_users&&t.push("manage_users"),e.can_view_logs&&t.push("view_logs"),e.can_manage_intent_config&&t.push("manage_intent_config"),e.can_access_tester_queue&&t.push("access_tester_queue"),e.can_submit_suggestions&&t.push("submit_suggestions"),e.can_manage_all_schools&&t.push("manage_all_schools"),e.can_access_system_settings&&t.push("access_system_settings")),t}logout(){localStorage.removeItem("token"),localStorage.removeItem("active_school_id")}getStoredToken(){return localStorage.getItem("token")}getStoredSchoolId(){return localStorage.getItem("active_school_id")}storeToken(e){localStorage.setItem("token",e)}storeSchoolId(e){localStorage.setItem("active_school_id",e)}}let n=new r},3299:function(e,t,s){"use strict";s.d(t,{g:function(){return n}});var a=s(459);class r{async getQueue(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams;return e.priority&&t.append("priority",e.priority.toString()),e.issue_type&&t.append("issue_type",e.issue_type),e.limit&&t.append("limit",e.limit.toString()),e.days_back&&t.append("days_back",e.days_back.toString()),e.school_id&&t.append("school_id",e.school_id),void 0!==e.show_suggested&&t.append("show_suggested",e.show_suggested.toString()),(await a.x.get("/api/tester/queue?".concat(t.toString()))).data}async getConversation(e,t){try{return(await a.x.get("/api/tester/conversation/".concat(e).concat(t?"?message_id=".concat(t):""))).data}catch(r){var s;if((null===(s=r.response)||void 0===s?void 0:s.status)===404)try{let s=(await a.x.get("/api/chat/conversations/".concat(e,"/messages"))).data.map(e=>({id:e.id||e.message_id,content:e.content||e.user_message||e.assistant_response,role:"USER"===e.message_type?"user":"assistant",timestamp:e.created_at,intent:e.intent,rating:e.rating,processing_time_ms:e.processing_time_ms,is_problematic:!!t&&(e.id===t||e.message_id===t)}));if(t){let e=s.findIndex(e=>e.id===t);if(e>0){let t=s.slice(0,e).reverse().find(e=>"user"===e.role),a=s[e];return t?[t,a]:[a]}return s.filter(e=>e.id===t)}return s}catch(e){throw Error("Unable to load conversation. This feature may not be available yet.")}throw r}}async submitSuggestion(e){let t={user_query:"regex_pattern",ai_response:"prompt_template",regex_pattern:"regex_pattern",prompt_template:"prompt_template",intent_mapping:"intent_mapping",handler_improvement:"handler_improvement"}[e.suggestion_type]||e.suggestion_type,s={message_id:e.message_id,routing_log_id:e.routing_log_id,suggestion_type:t,title:e.title,description:e.description,handler:e.handler,intent:e.intent,pattern:e.pattern,template_text:e.template_text,priority:e.priority||"medium",tester_note:e.tester_note};return(await a.x.post("/api/tester/suggestions",s)).data}async getMySuggestions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams;return e.limit&&t.append("limit",e.limit.toString()),e.status&&t.append("status",e.status),e.suggestion_type&&t.append("suggestion_type",e.suggestion_type),(await a.x.get("/api/tester/suggestions?".concat(t.toString()))).data}async getStats(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams;return e.days_back&&t.append("days_back",e.days_back.toString()),e.school_id&&t.append("school_id",e.school_id),(await a.x.get("/api/tester/stats?".concat(t.toString()))).data}async getFilters(){return(await a.x.get("/api/tester/filters")).data}getSuggestionTypes(){return[{value:"regex_pattern",label:"Regex Pattern",description:"Add or improve message classification patterns"},{value:"prompt_template",label:"Prompt Template",description:"Improve response templates for better answers"},{value:"intent_mapping",label:"Intent Mapping",description:"Better intent classification for specific handlers"},{value:"handler_improvement",label:"Handler Improvement",description:"General handler behavior improvements"}]}getPriorityLevels(){return[{value:"critical",label:"Critical",description:"Urgent fixes for broken responses"},{value:"high",label:"High",description:"Important improvements for common issues"},{value:"medium",label:"Medium",description:"General improvements and optimizations"},{value:"low",label:"Low",description:"Minor enhancements and edge cases"}]}getIssueTypeLabels(){return{negative_rating:"User gave thumbs down",fallback:"Fallback response used",low_confidence:"Low classification confidence",unhandled:"Unhandled intent"}}getPriorityLabels(){return{1:"High",2:"Medium",3:"Low"}}getPriorityColor(e){switch(e){case 1:return"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-200";case 2:return"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-200";default:return"bg-gray-100 dark:bg-gray-900/30 text-gray-800 dark:text-gray-200"}}getIssueTypeColor(e){switch(e){case"negative_rating":return"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-200";case"fallback":return"bg-orange-100 dark:bg-orange-900/30 text-orange-800 dark:text-orange-200";case"low_confidence":return"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-200";case"unhandled":return"bg-purple-100 dark:bg-purple-900/30 text-purple-800 dark:text-purple-200";default:return"bg-gray-100 dark:bg-gray-900/30 text-gray-800 dark:text-gray-200"}}getSuggestionStatusColor(e){switch(e){case"pending":default:return"bg-gray-100 dark:bg-gray-900/30 text-gray-800 dark:text-gray-200";case"approved":return"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-200";case"rejected":return"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-200";case"implemented":return"bg-purple-100 dark:bg-purple-900/30 text-purple-800 dark:text-purple-200"}}}let n=new r},4839:function(e,t,s){"use strict";function a(){for(var e,t,s=0,a="",r=arguments.length;s<r;s++)(e=arguments[s])&&(t=function e(t){var s,a,r="";if("string"==typeof t||"number"==typeof t)r+=t;else if("object"==typeof t){if(Array.isArray(t)){var n=t.length;for(s=0;s<n;s++)t[s]&&(a=e(t[s]))&&(r&&(r+=" "),r+=a)}else for(a in t)t[a]&&(r&&(r+=" "),r+=a)}return r}(e))&&(a&&(a+=" "),a+=t);return a}s.d(t,{W:function(){return a}}),t.Z=a}},function(e){e.O(0,[236,971,23,744],function(){return e(e.s=8054)}),_N_E=e.O()}]);