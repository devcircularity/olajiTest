(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[29],{2690:function(e,t,s){Promise.resolve().then(s.bind(s,3252))},3252:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return v}});var a=s(7437),l=s(2265),n=s(857),i=s(3299),r=s(1702),d=s(5733),c=s(2513),o=s(6706),x=s(6127),m=s(7390),p=s(933);let u=(0,s(8030).Z)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);var g=s(5607),h=s(4308);function v(){var e,t,s;let{user:v}=(0,n.a)(),[j,f]=(0,l.useState)([]),[y,N]=(0,l.useState)(!0),[k,_]=(0,l.useState)(""),[w,C]=(0,l.useState)(""),[S,I]=(0,l.useState)(7),[M,Z]=(0,l.useState)(null),[L,D]=(0,l.useState)(!1);(0,l.useEffect)(()=>{P()},[k,w,S]);let P=async()=>{try{N(!0);let e={days_back:S,limit:100,...k&&{priority:parseInt(k)},...w&&{issue_type:w}},t=await i.g.getQueue(e);f(t)}catch(e){console.error("Failed to load queue:",e)}finally{N(!1)}},A=e=>({1:"High",2:"Medium",3:"Low"})[e]||"Unknown",R=e=>{switch(e){case 1:return"bg-red-100 text-red-800";case 2:return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},U=e=>({negative_rating:"Negative Rating",fallback:"Fallback Used",low_confidence:"Low Confidence",unhandled:"Unhandled"})[e]||e,z=e=>{switch(e){case"negative_rating":return"bg-red-100 text-red-800";case"fallback":return"bg-yellow-100 text-yellow-800";case"low_confidence":return"bg-orange-100 text-orange-800";case"unhandled":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},T=[{key:"created_at",label:"Time",render:e=>{let t=new Date(e),s=Math.floor((new Date().getTime()-t.getTime())/6e4);return s<1?(0,a.jsx)("span",{className:"text-xs sm:text-sm",children:"Just now"}):s<60?(0,a.jsxs)("span",{className:"text-xs sm:text-sm",children:[s,"m ago"]}):s<1440?(0,a.jsxs)("span",{className:"text-xs sm:text-sm",children:[Math.floor(s/60),"h ago"]}):(0,a.jsx)("span",{className:"text-xs sm:text-sm",children:t.toLocaleDateString()})},width:"100px",sortable:!0},{key:"priority",label:"Priority",render:e=>(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat(R(e)),children:A(e)}),width:"100px",sortable:!0},{key:"issue_type",label:"Issue Type",render:e=>(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat(z(e)),children:U(e)}),width:"140px"},{key:"user_message",label:"User Message",render:e=>(0,a.jsx)("div",{className:"max-w-xs truncate text-xs sm:text-sm break-words",title:e,children:e})},{key:"assistant_response",label:"AI Response",render:e=>(0,a.jsx)("div",{className:"max-w-xs truncate text-xs sm:text-sm break-words",title:e,children:e})},{key:"intent",label:"Intent",render:e=>e?(0,a.jsx)("code",{className:"text-xs bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded break-all",children:e}):"-",width:"120px"},{key:"rating",label:"Rating",render:e=>1===e?(0,a.jsx)("span",{className:"text-green-600",children:"\uD83D\uDC4D"}):-1===e?(0,a.jsx)("span",{className:"text-red-600",children:"\uD83D\uDC4E"}):(0,a.jsx)("span",{className:"text-gray-400",children:"-"}),width:"60px"},{key:"llm_confidence",label:"Confidence",render:e=>e?(0,a.jsxs)("span",{className:"text-xs ".concat(e>=.8?"text-green-600":e>=.6?"text-yellow-600":"text-red-600"),children:[(100*e).toFixed(0),"%"]}):"-",width:"80px"}],F=[{label:"View Details",icon:(0,a.jsx)(d.Z,{size:14}),onClick:e=>{Z(e)},variant:"secondary"},{label:"Create Suggestion",icon:(0,a.jsx)(c.Z,{size:14}),onClick:e=>{Z(e),D(!0)},variant:"primary"}];return(null==v?void 0:null===(e=v.permissions)||void 0===e?void 0:e.is_tester)||(null==v?void 0:null===(t=v.permissions)||void 0===t?void 0:t.is_admin)||(null==v?void 0:null===(s=v.permissions)||void 0===s?void 0:s.is_super_admin)?(0,a.jsxs)("div",{className:"p-4 sm:p-6",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 sm:mb-6 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl sm:text-2xl font-bold mb-2",children:"Problem Queue"}),(0,a.jsxs)("p",{className:"text-sm sm:text-base text-neutral-600",children:["Messages that need tester attention (",j.length," items)"]})]}),(0,a.jsxs)(h.Z,{onClick:P,className:"btn-secondary flex items-center gap-2 text-sm",children:[(0,a.jsx)(o.Z,{size:16}),"Refresh"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 mb-4 sm:mb-6",children:[(0,a.jsxs)("div",{className:"card p-3 sm:p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(x.Z,{className:"text-red-600 flex-shrink-0",size:14}),(0,a.jsx)("h3",{className:"text-xs sm:text-sm font-medium text-neutral-600 truncate",children:"High Priority"})]}),(0,a.jsx)("p",{className:"text-lg sm:text-2xl font-bold text-red-600",children:j.filter(e=>1===e.priority).length})]}),(0,a.jsxs)("div",{className:"card p-3 sm:p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(m.Z,{className:"text-orange-600 flex-shrink-0",size:14}),(0,a.jsx)("h3",{className:"text-xs sm:text-sm font-medium text-neutral-600 truncate",children:"Negative Ratings"})]}),(0,a.jsx)("p",{className:"text-lg sm:text-2xl font-bold text-orange-600",children:j.filter(e=>-1===e.rating).length})]}),(0,a.jsxs)("div",{className:"card p-3 sm:p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(p.Z,{className:"text-yellow-600 flex-shrink-0",size:14}),(0,a.jsx)("h3",{className:"text-xs sm:text-sm font-medium text-neutral-600 truncate",children:"Fallback Used"})]}),(0,a.jsx)("p",{className:"text-lg sm:text-2xl font-bold text-yellow-600",children:j.filter(e=>e.fallback_used).length})]}),(0,a.jsxs)("div",{className:"card p-3 sm:p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(u,{className:"text-purple-600 flex-shrink-0",size:14}),(0,a.jsx)("h3",{className:"text-xs sm:text-sm font-medium text-neutral-600 truncate",children:"Low Confidence"})]}),(0,a.jsx)("p",{className:"text-lg sm:text-2xl font-bold text-purple-600",children:j.filter(e=>e.llm_confidence&&e.llm_confidence<.6).length})]})]}),(0,a.jsx)("div",{className:"card p-3 sm:p-4 mb-4 sm:mb-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 xl:grid-cols-5 gap-3 sm:gap-4 items-end",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs sm:text-sm font-medium mb-1",children:"Time Range"}),(0,a.jsxs)("select",{value:S,onChange:e=>I(Number(e.target.value)),className:"input w-full text-sm",children:[(0,a.jsx)("option",{value:1,children:"Last 24h"}),(0,a.jsx)("option",{value:3,children:"Last 3 days"}),(0,a.jsx)("option",{value:7,children:"Last week"}),(0,a.jsx)("option",{value:14,children:"Last 2 weeks"}),(0,a.jsx)("option",{value:30,children:"Last month"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs sm:text-sm font-medium mb-1",children:"Priority"}),(0,a.jsxs)("select",{value:k,onChange:e=>_(e.target.value),className:"input w-full text-sm",children:[(0,a.jsx)("option",{value:"",children:"All"}),(0,a.jsx)("option",{value:"1",children:"High"}),(0,a.jsx)("option",{value:"2",children:"Medium"}),(0,a.jsx)("option",{value:"3",children:"Low"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs sm:text-sm font-medium mb-1",children:"Issue Type"}),(0,a.jsxs)("select",{value:w,onChange:e=>C(e.target.value),className:"input w-full text-sm",children:[(0,a.jsx)("option",{value:"",children:"All Issues"}),(0,a.jsx)("option",{value:"negative_rating",children:"Negative Rating"}),(0,a.jsx)("option",{value:"fallback",children:"Fallback Used"}),(0,a.jsx)("option",{value:"low_confidence",children:"Low Confidence"}),(0,a.jsx)("option",{value:"unhandled",children:"Unhandled"})]})]}),(0,a.jsx)("div",{className:"sm:col-span-2 lg:col-span-1",children:(0,a.jsxs)(h.Z,{onClick:()=>{_(""),C(""),I(7)},className:"btn-secondary flex items-center gap-2 w-full sm:w-auto text-sm",children:[(0,a.jsx)(g.Z,{size:16}),"Clear Filters"]})})]})}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsx)(r.Z,{data:j,columns:T,actions:F,loading:y,searchable:!0,searchPlaceholder:"Search messages...",emptyMessage:"No problematic messages found",className:"text-xs sm:text-sm"})}),M&&!L&&(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50",onClick:()=>Z(null)}),(0,a.jsx)("div",{className:"relative bg-white dark:bg-neutral-800 rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:(0,a.jsxs)("div",{className:"p-4 sm:p-6",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start mb-4 sm:mb-6 gap-3",children:[(0,a.jsx)("h2",{className:"text-lg sm:text-xl font-bold",children:"Message Details"}),(0,a.jsx)(h.Z,{onClick:()=>Z(null),className:"btn-secondary text-sm",children:"Close"})]}),(0,a.jsxs)("div",{className:"space-y-4 sm:space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{className:"text-sm",children:"Issue Type:"}),(0,a.jsx)("span",{className:"ml-2 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat(z(M.issue_type)),children:U(M.issue_type)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{className:"text-sm",children:"Priority:"}),(0,a.jsx)("span",{className:"ml-2 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat(R(M.priority)),children:A(M.priority)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{className:"text-sm",children:"Intent:"}),(0,a.jsx)("span",{className:"ml-2 text-sm",children:M.intent||"None"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{className:"text-sm",children:"Rating:"}),1===M.rating&&(0,a.jsx)("span",{className:"text-green-600 ml-2",children:"\uD83D\uDC4D Positive"}),-1===M.rating&&(0,a.jsx)("span",{className:"text-red-600 ml-2",children:"\uD83D\uDC4E Negative"}),!M.rating&&(0,a.jsx)("span",{className:"text-gray-500 ml-2",children:"No rating"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{className:"text-sm",children:"Created:"}),(0,a.jsx)("span",{className:"ml-2 text-sm",children:new Date(M.created_at).toLocaleString()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{className:"text-sm",children:"Processing Time:"}),(0,a.jsx)("span",{className:"ml-2 text-sm",children:M.processing_time_ms?"".concat(M.processing_time_ms,"ms"):"N/A"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{className:"text-sm sm:text-base",children:"User Message:"}),(0,a.jsxs)("div",{className:"mt-2 p-3 sm:p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[(0,a.jsx)(m.Z,{className:"inline mr-2 flex-shrink-0",size:16}),(0,a.jsx)("span",{className:"text-sm whitespace-pre-wrap break-words",children:M.user_message})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{className:"text-sm sm:text-base",children:"AI Response:"}),(0,a.jsx)("div",{className:"mt-2 p-3 sm:p-4 bg-neutral-50 dark:bg-neutral-700 rounded-lg",children:(0,a.jsx)("span",{className:"text-sm whitespace-pre-wrap break-words",children:M.assistant_response})})]}),M.routing_log_id&&(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{className:"text-sm sm:text-base",children:"Routing Information:"}),(0,a.jsxs)("div",{className:"mt-2 grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"LLM Intent:"}),(0,a.jsx)("span",{className:"ml-2 break-words",children:M.llm_intent||"N/A"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"LLM Confidence:"}),(0,a.jsx)("span",{className:"ml-2",children:M.llm_confidence?(100*M.llm_confidence).toFixed(1)+"%":"N/A"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"Router Intent:"}),(0,a.jsx)("span",{className:"ml-2 break-words",children:M.router_intent||"N/A"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"Final Intent:"}),(0,a.jsx)("span",{className:"ml-2 break-words",children:M.final_intent||"N/A"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"Fallback Used:"}),(0,a.jsx)("span",{className:"ml-2 ".concat(M.fallback_used?"text-red-600":"text-green-600"),children:M.fallback_used?"Yes":"No"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"User ID:"}),(0,a.jsx)("span",{className:"ml-2 font-mono text-xs break-all",children:M.user_id})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{className:"text-sm sm:text-base",children:"Context Information:"}),(0,a.jsxs)("div",{className:"mt-2 grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"Conversation ID:"}),(0,a.jsx)("span",{className:"ml-2 font-mono text-xs break-all",children:M.conversation_id})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"School ID:"}),(0,a.jsx)("span",{className:"ml-2 font-mono text-xs break-all",children:M.school_id||"N/A"})]}),M.rated_at&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"Rated At:"}),(0,a.jsx)("span",{className:"ml-2 text-sm",children:new Date(M.rated_at).toLocaleString()})]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-4 pt-4 border-t",children:[(0,a.jsxs)(h.Z,{onClick:()=>D(!0),className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)(c.Z,{size:16}),"Create Suggestion"]}),(0,a.jsxs)(h.Z,{onClick:()=>window.open("/admin/monitoring?conversation=".concat(M.conversation_id),"_blank"),className:"btn-secondary flex items-center gap-2 text-sm",children:[(0,a.jsx)(d.Z,{size:16}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"View Full Conversation"}),(0,a.jsx)("span",{className:"sm:hidden",children:"View Conversation"})]})]})]})]})})]}),L&&M&&(0,a.jsx)(b,{message:M,onClose:()=>{D(!1),Z(null)},onSubmit:()=>{D(!1),Z(null)}})]}):(0,a.jsx)("div",{className:"p-4 sm:p-6",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-xl sm:text-2xl font-bold mb-4",children:"Access Denied"}),(0,a.jsx)("p",{className:"text-neutral-600",children:"You don't have permission to access the tester queue."})]})})}function b(e){var t,s;let{message:n,onClose:r,onSubmit:d}=e,[c,o]=(0,l.useState)({suggestion_type:"prompt_template",title:"",description:"",handler:n.intent||"",intent:n.intent||"",pattern:"",template_text:"",priority:"medium",tester_note:""}),[x,m]=(0,l.useState)(!1);(0,l.useEffect)(()=>{let e={negative_rating:{suggestion_type:"prompt_template",title:"Improve response for negative feedback",description:"User gave thumbs down to this response. Consider improving the prompt template to provide more helpful answers."},fallback:{suggestion_type:"regex_pattern",title:"Add pattern to prevent fallback",description:"Fallback response was triggered. Add regex pattern to better classify this type of message."},low_confidence:{suggestion_type:"intent_mapping",title:"Improve intent classification",description:"LLM had low confidence in intent classification. Consider adding training examples or refining patterns."},unhandled:{suggestion_type:"intent_mapping",title:"Handle unhandled intent",description:"No appropriate handler was found for this message. Consider creating new intent mapping or handler."}}[n.issue_type];e&&o(t=>({...t,...e}))},[n.issue_type]);let p=async()=>{if(!c.title||!c.description){alert("Please fill in title and description");return}if("regex_pattern"===c.suggestion_type&&!c.pattern){alert("Please provide a regex pattern");return}if("prompt_template"===c.suggestion_type&&!c.template_text){alert("Please provide template text");return}try{m(!0),await i.g.submitSuggestion({message_id:n.message_id,routing_log_id:n.routing_log_id,suggestion_type:c.suggestion_type,title:c.title,description:c.description,handler:c.handler,intent:c.intent,pattern:c.pattern||void 0,template_text:c.template_text||void 0,priority:c.priority,tester_note:c.tester_note||void 0}),alert("Suggestion submitted successfully!"),d()}catch(e){console.error("Failed to submit suggestion:",e),alert("Failed to submit suggestion. Please try again.")}finally{m(!1)}},u=()=>[{value:"regex_pattern",label:"Regex Pattern",description:"Add a regex pattern to improve classification"},{value:"prompt_template",label:"Prompt Template",description:"Improve the AI response template"},{value:"intent_mapping",label:"Intent Mapping",description:"Create or modify intent mapping"},{value:"error_handling",label:"Error Handling",description:"Improve error handling"}],g=()=>[{value:"low",label:"Low",description:"Nice to have improvement"},{value:"medium",label:"Medium",description:"Should be addressed"},{value:"high",label:"High",description:"Important fix needed"},{value:"critical",label:"Critical",description:"Urgent issue affecting users"}];return(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50",onClick:r}),(0,a.jsx)("div",{className:"relative bg-white dark:bg-neutral-800 rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,a.jsxs)("div",{className:"p-4 sm:p-6",children:[(0,a.jsx)("h2",{className:"text-lg sm:text-xl font-bold mb-3 sm:mb-4",children:"Create Suggestion"}),(0,a.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"label text-xs sm:text-sm",children:"Suggestion Type"}),(0,a.jsx)("select",{value:c.suggestion_type,onChange:e=>o(t=>({...t,suggestion_type:e.target.value})),className:"input text-sm",children:u().map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,a.jsx)("p",{className:"text-xs text-neutral-500 mt-1",children:null===(t=u().find(e=>e.value===c.suggestion_type))||void 0===t?void 0:t.description})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"label text-xs sm:text-sm",children:"Title"}),(0,a.jsx)("input",{type:"text",value:c.title,onChange:e=>o(t=>({...t,title:e.target.value})),className:"input text-sm",placeholder:"Brief description of the suggestion",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"label text-xs sm:text-sm",children:"Description"}),(0,a.jsx)("textarea",{value:c.description,onChange:e=>o(t=>({...t,description:e.target.value})),className:"input min-h-24 text-sm",placeholder:"Detailed explanation of the issue and proposed solution",required:!0})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"label text-xs sm:text-sm",children:"Handler"}),(0,a.jsx)("input",{type:"text",value:c.handler,onChange:e=>o(t=>({...t,handler:e.target.value})),className:"input text-sm",placeholder:"e.g., homework_help"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"label text-xs sm:text-sm",children:"Intent"}),(0,a.jsx)("input",{type:"text",value:c.intent,onChange:e=>o(t=>({...t,intent:e.target.value})),className:"input text-sm",placeholder:"e.g., get_assignment"})]})]}),"regex_pattern"===c.suggestion_type&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"label text-xs sm:text-sm",children:"Regex Pattern"}),(0,a.jsx)("input",{type:"text",value:c.pattern,onChange:e=>o(t=>({...t,pattern:e.target.value})),className:"input font-mono text-sm",placeholder:"(?i)\\\\b(homework|assignment)\\\\b.*\\\\b(help|assist)"}),(0,a.jsx)("p",{className:"text-xs text-neutral-500 mt-1",children:"Regular expression pattern for matching user messages. Use (?i) for case-insensitive matching."})]}),"prompt_template"===c.suggestion_type&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"label text-xs sm:text-sm",children:"Template Text"}),(0,a.jsx)("textarea",{value:c.template_text,onChange:e=>o(t=>({...t,template_text:e.target.value})),className:"input min-h-32 font-mono text-sm",placeholder:"Improved response template with clear, helpful guidance..."}),(0,a.jsx)("p",{className:"text-xs text-neutral-500 mt-1",children:"Provide a better template that would improve the AI's response to this type of query."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"label text-xs sm:text-sm",children:"Priority"}),(0,a.jsx)("select",{value:c.priority,onChange:e=>o(t=>({...t,priority:e.target.value})),className:"input text-sm",children:g().map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,a.jsx)("p",{className:"text-xs text-neutral-500 mt-1",children:null===(s=g().find(e=>e.value===c.priority))||void 0===s?void 0:s.description})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"label text-xs sm:text-sm",children:"Tester Note (Optional)"}),(0,a.jsx)("textarea",{value:c.tester_note,onChange:e=>o(t=>({...t,tester_note:e.target.value})),className:"input min-h-20 text-sm",placeholder:"Additional context, testing notes, or implementation guidance for admins..."})]}),(0,a.jsxs)("div",{className:"border-t pt-3 sm:pt-4",children:[(0,a.jsx)("h4",{className:"font-semibold mb-2 text-sm sm:text-base",children:"Related Message Context:"}),(0,a.jsxs)("div",{className:"text-xs sm:text-sm space-y-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"User:"})," ",(0,a.jsx)("span",{className:"break-words",children:n.user_message})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"AI:"})," ",(0,a.jsx)("span",{className:"break-words",children:n.assistant_response})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Issue:"})," ",n.issue_type]})]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3 mt-4 sm:mt-6",children:[(0,a.jsx)(h.Z,{onClick:p,disabled:x||!c.title||!c.description,className:"flex-1 text-sm",children:x?"Submitting...":"Submit Suggestion"}),(0,a.jsx)(h.Z,{onClick:r,className:"btn-secondary flex-1 text-sm",children:"Cancel"})]})]})})]})}},933:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(8030).Z)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},5733:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(8030).Z)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},5607:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(8030).Z)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]])},7390:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(8030).Z)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]])},2513:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(8030).Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},6706:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(8030).Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},6127:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(8030).Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},3299:function(e,t,s){"use strict";s.d(t,{g:function(){return n}});var a=s(459);class l{async getQueue(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams;return e.priority&&t.append("priority",e.priority.toString()),e.issue_type&&t.append("issue_type",e.issue_type),e.limit&&t.append("limit",e.limit.toString()),e.days_back&&t.append("days_back",e.days_back.toString()),e.school_id&&t.append("school_id",e.school_id),(await a.x.get("/api/tester/queue?".concat(t.toString()))).data}async submitSuggestion(e){return(await a.x.post("/api/tester/suggestions",e)).data}async getMySuggestions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams;return e.limit&&t.append("limit",e.limit.toString()),e.status&&t.append("status",e.status),e.suggestion_type&&t.append("suggestion_type",e.suggestion_type),(await a.x.get("/api/tester/suggestions?".concat(t.toString()))).data}async getStats(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams;return e.days_back&&t.append("days_back",e.days_back.toString()),e.school_id&&t.append("school_id",e.school_id),(await a.x.get("/api/tester/stats?".concat(t.toString()))).data}async getFilters(){return(await a.x.get("/api/tester/filters")).data}getSuggestionTypes(){return[{value:"regex_pattern",label:"Regex Pattern",description:"Add or improve message classification patterns"},{value:"prompt_template",label:"Prompt Template",description:"Improve response templates for better answers"},{value:"intent_mapping",label:"Intent Mapping",description:"Better intent classification for specific handlers"},{value:"handler_improvement",label:"Handler Improvement",description:"General handler behavior improvements"}]}getPriorityLevels(){return[{value:"critical",label:"Critical",description:"Urgent fixes for broken responses"},{value:"high",label:"High",description:"Important improvements for common issues"},{value:"medium",label:"Medium",description:"General improvements and optimizations"},{value:"low",label:"Low",description:"Minor enhancements and edge cases"}]}getIssueTypeLabels(){return{negative_rating:"User gave thumbs down",fallback:"Fallback response used",low_confidence:"Low classification confidence",unhandled:"Unhandled intent"}}getPriorityLabels(){return{1:"High",2:"Medium",3:"Low"}}getPriorityColor(e){switch(e){case 1:return"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-200";case 2:return"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-200";default:return"bg-gray-100 dark:bg-gray-900/30 text-gray-800 dark:text-gray-200"}}getIssueTypeColor(e){switch(e){case"negative_rating":return"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-200";case"fallback":return"bg-orange-100 dark:bg-orange-900/30 text-orange-800 dark:text-orange-200";case"low_confidence":return"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-200";case"unhandled":return"bg-purple-100 dark:bg-purple-900/30 text-purple-800 dark:text-purple-200";default:return"bg-gray-100 dark:bg-gray-900/30 text-gray-800 dark:text-gray-200"}}getSuggestionStatusColor(e){switch(e){case"pending":default:return"bg-gray-100 dark:bg-gray-900/30 text-gray-800 dark:text-gray-200";case"approved":return"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-200";case"rejected":return"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-200";case"implemented":return"bg-purple-100 dark:bg-purple-900/30 text-purple-800 dark:text-purple-200"}}}let n=new l}},function(e){e.O(0,[236,32,971,23,744],function(){return e(e.s=2690)}),_N_E=e.O()}]);