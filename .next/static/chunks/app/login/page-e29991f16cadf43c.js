(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{476:function(e,a,n){Promise.resolve().then(n.bind(n,5207))},5207:function(e,a,n){"use strict";n.r(a),n.d(a,{default:function(){return p}});var l=n(7437),s=n(6463),o=n(857),t=n(1785),r=n(2265),i=n(7138),c=n(5520),u=n(5950),d=n(8234),h=n(4308);function m(){let e=(0,s.useRouter)(),a=(0,s.useSearchParams)().get("next")||"/",{login:n,setSchoolId:m}=(0,o.a)(),[p,f]=(0,r.useState)(""),[g,v]=(0,r.useState)(""),[x,j]=(0,r.useState)(null),[w,b]=(0,r.useState)(!1);async function N(l){l.preventDefault(),j(null),b(!0);try{let l=await t.O.login({email:p,password:g}),s=null==l?void 0:l.access_token;if(!s)throw console.error("Login response:",l),Error("No access token in response");await n({token:s});let o=null==l?void 0:l.school_id;o?(m(o.toString()),e.replace(a)):e.replace("/onboarding/school?next=".concat(encodeURIComponent(a)))}catch(e){var s,o;console.error("Login error:",e),j((null==e?void 0:null===(o=e.response)||void 0===o?void 0:null===(s=o.data)||void 0===s?void 0:s.detail)||(null==e?void 0:e.message)||"Login failed")}finally{b(!1)}}return(0,l.jsxs)(c.Z,{title:"Welcome back",subtitle:"Sign in to manage your school",children:[(0,l.jsxs)("form",{onSubmit:N,className:"space-y-4",noValidate:!0,children:[(0,l.jsx)(u.Z,{id:"email",label:"Email",type:"email",value:p,onChange:e=>f(e.target.value),placeholder:"email address",autoComplete:"email",required:!0}),(0,l.jsx)(d.Z,{id:"password",label:"Password",value:g,onChange:e=>v(e.target.value),placeholder:"Password",autoComplete:"current-password",required:!0}),(0,l.jsx)(h.Z,{className:"w-full",disabled:w,children:w?"Signing inâ€¦":"Continue"})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between text-sm mt-4",children:[(0,l.jsx)(i.default,{href:"/forgot-password",className:"link",children:"Forgot password?"}),(0,l.jsxs)("span",{className:"opacity-80",children:["Don't have an account? ",(0,l.jsx)(i.default,{href:"/signup",className:"link",children:"Create one"})]})]}),x&&(0,l.jsx)("p",{className:"error-text mt-3",role:"alert","aria-live":"polite",children:x})]})}function p(){return(0,l.jsx)(r.Suspense,{fallback:(0,l.jsx)("div",{children:"Loading..."}),children:(0,l.jsx)(m,{})})}}},function(e){e.O(0,[236,138,490,971,23,744],function(){return e(e.s=476)}),_N_E=e.O()}]);