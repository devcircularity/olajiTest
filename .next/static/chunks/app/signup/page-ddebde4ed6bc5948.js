(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[966],{3040:function(e,a,l){Promise.resolve().then(l.bind(l,1039))},1039:function(e,a,l){"use strict";l.r(a),l.d(a,{default:function(){return m}});var n=l(7437),r=l(7138),s=l(6463),t=l(2265),o=l(857),i=l(1785),u=l(5520),c=l(5950),d=l(8234),p=l(4308);function h(){let e=(0,s.useRouter)(),a=(0,s.useSearchParams)().get("next")||"/",{login:l,setSchoolId:h}=(0,o.a)(),[m,f]=(0,t.useState)(""),[g,v]=(0,t.useState)(""),[x,w]=(0,t.useState)(""),[j,C]=(0,t.useState)(""),[S,b]=(0,t.useState)(null),[y,N]=(0,t.useState)(!1);async function k(n){var r,s,t;if(n.preventDefault(),b(null),x!==j){b("Passwords do not match");return}N(!0);try{let n=await i.O.signup({full_name:m,email:g,password:x}),s=null==n?void 0:n.access_token;if(!s)throw console.error("Signup response:",n),Error("No access token returned");await l({token:s});let t=null!==(r=null==n?void 0:n.school_id)&&void 0!==r?r:null;t?(h(t),e.replace(a)):e.replace("/onboarding/school?next=".concat(encodeURIComponent(a)))}catch(e){console.error("Signup error:",e),b((null==e?void 0:null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.detail)||(null==e?void 0:e.message)||"Sign up failed")}finally{N(!1)}}let _=!x||!j||x===j;return(0,n.jsxs)(u.Z,{title:"Create your account",subtitle:"Start organizing your school",children:[(0,n.jsxs)("form",{onSubmit:k,className:"space-y-4",noValidate:!0,children:[(0,n.jsx)(c.Z,{id:"full-name",label:"Full name",value:m,onChange:e=>f(e.target.value),placeholder:"Jane Doe",autoComplete:"name",required:!0}),(0,n.jsx)(c.Z,{id:"signup-email",label:"Email",type:"email",value:g,onChange:e=>v(e.target.value),placeholder:"you@example.com",autoComplete:"email",required:!0}),(0,n.jsx)(d.Z,{id:"signup-password",label:"Password",value:x,onChange:e=>w(e.target.value),placeholder:"Password",helperText:"Use at least 6 characters.",autoComplete:"new-password",required:!0}),(0,n.jsx)(d.Z,{id:"confirm-password",label:"Confirm password",value:j,onChange:e=>C(e.target.value),placeholder:"Password",autoComplete:"new-password",required:!0,error:x&&j&&x!==j?"Passwords do not match":null}),(0,n.jsx)(p.Z,{className:"w-full",disabled:y||!_,children:y?"Creatingâ€¦":"Create account"})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between text-sm mt-4",children:[(0,n.jsxs)("span",{className:"opacity-80",children:["Already have an account? ",(0,n.jsx)(r.default,{className:"link",href:"/login",children:"Sign in"})]}),(0,n.jsx)(r.default,{href:"/forgot-password",className:"link",children:"Forgot password?"})]}),S&&(0,n.jsx)("p",{className:"error-text mt-3",role:"alert","aria-live":"polite",children:S})]})}function m(){return(0,n.jsx)(t.Suspense,{fallback:(0,n.jsx)("div",{children:"Loading..."}),children:(0,n.jsx)(h,{})})}}},function(e){e.O(0,[236,138,490,971,23,744],function(){return e(e.s=3040)}),_N_E=e.O()}]);