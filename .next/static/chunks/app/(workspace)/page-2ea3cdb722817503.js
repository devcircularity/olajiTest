(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[307],{2455:function(e,t,a){Promise.resolve().then(a.bind(a,5579))},5579:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return u}});var l=a(7437),s=a(2265),r=a(6463),n=a(857),i=a(7138);function o(e){let{open:t,onClose:a,onLogout:r,userLabel:n,email:i,schoolId:o}=e;if((0,s.useEffect)(()=>{function e(e){"Escape"===e.key&&a()}return t&&document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[t,a]),!t)return null;let c=(n||i||"U").slice(0,1).toUpperCase();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"fixed inset-0 z-[90] bg-black/40 backdrop-blur-[2px]",onClick:a}),(0,l.jsxs)("div",{className:"fixed right-4 top-16 z-[100] w-[360px] sm:w-[380px] rounded-[1.25rem] card border border-neutral-200/60 overflow-hidden shadow-[var(--shadow-soft)]",onClick:e=>e.stopPropagation(),role:"dialog","aria-modal":"true",children:[(0,l.jsxs)("div",{className:"relative px-4 py-3 bg-neutral-900/5 dark:bg-white/5",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-[--color-brand] text-white font-semibold",children:c}),(0,l.jsxs)("div",{className:"min-w-0",children:[i&&(0,l.jsx)("div",{className:"text-xs text-neutral-500 dark:text-neutral-400 truncate",children:i}),(0,l.jsx)("div",{className:"text-sm font-medium truncate",children:n||"User"})]})]}),(0,l.jsx)("button",{onClick:a,className:"absolute right-3 top-3 text-neutral-500 hover:text-neutral-800 dark:hover:text-neutral-200","aria-label":"Close",children:"✕"})]}),(0,l.jsxs)("div",{className:"px-5 pt-4 pb-3",children:[(0,l.jsxs)("div",{className:"text-lg font-semibold",children:["Hi",n?", ".concat(n.split(" ")[0],"!"):"!"]}),(0,l.jsx)("button",{className:"mt-3 btn-primary w-full rounded-xl py-2.5",onClick:()=>alert("Manage account (stub)"),children:"Manage your Account"})]}),(0,l.jsx)("div",{className:"mx-4 mb-3 rounded-2xl bg-neutral-100 dark:bg-neutral-800 p-4",children:(0,l.jsxs)("div",{className:"flex items-start gap-3",children:[(0,l.jsx)("div",{className:"text-xl leading-none",children:"\uD83C\uDFE0"}),(0,l.jsxs)("div",{className:"text-sm",children:[(0,l.jsx)("div",{className:"font-medium",children:"Set your school & year"}),(0,l.jsx)("div",{className:"text-neutral-600 dark:text-neutral-400",children:"Pick active school and academic year for better results."}),(0,l.jsxs)("div",{className:"mt-2 flex gap-3",children:[(0,l.jsx)("button",{className:"btn rounded-lg px-3 py-1.5 hover:bg-neutral-200 dark:hover:bg-neutral-700",children:"Dismiss"}),(0,l.jsx)("button",{className:"link-subtle",children:"Open settings"})]})]})]})}),(0,l.jsx)("div",{className:"px-4",children:(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,l.jsx)("button",{className:"btn rounded-xl px-3 py-2 bg-neutral-100 dark:bg-neutral-800 hover:bg-neutral-200 dark:hover:bg-neutral-700",onClick:()=>alert("Add account (stub)"),children:"+ Add account"}),(0,l.jsx)("button",{className:"btn rounded-xl px-3 py-2 bg-neutral-100 dark:bg-neutral-800 hover:bg-neutral-200 dark:hover:bg-neutral-700",onClick:()=>{a(),r()},children:"Sign out"})]})}),(0,l.jsx)("div",{className:"mt-3 px-2 pb-2",children:(0,l.jsxs)("ul",{className:"grid gap-2",children:[(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left rounded-xl px-3 py-2 hover:bg-neutral-100 dark:hover:bg-neutral-800",children:["\uD83D\uDD0E ",(0,l.jsx)("span",{className:"ml-2",children:"Search history"}),(0,l.jsx)("span",{className:"float-right text-xs text-neutral-500",children:"Not saving"})]})}),(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left rounded-xl px-3 py-2 hover:bg-neutral-100 dark:hover:bg-neutral-800",children:["\uD83D\uDCC1 ",(0,l.jsx)("span",{className:"ml-2",children:"Saves & Collections"})]})}),(0,l.jsx)("li",{children:(0,l.jsxs)("button",{className:"w-full text-left rounded-xl px-3 py-2 hover:bg-neutral-100 dark:hover:bg-neutral-800",children:["✨ ",(0,l.jsx)("span",{className:"ml-2",children:"Search personalization"})]})}),(0,l.jsxs)("li",{className:"grid grid-cols-2 gap-2",children:[(0,l.jsxs)("button",{className:"rounded-xl px-3 py-2 hover:bg-neutral-100 dark:hover:bg-neutral-800 text-left",children:["\uD83D\uDEE1️ ",(0,l.jsx)("span",{className:"ml-2",children:"SafeSearch"}),(0,l.jsx)("div",{className:"text-xs text-neutral-500 ml-7 -mt-1",children:"Blurring on"})]}),(0,l.jsxs)("button",{className:"rounded-xl px-3 py-2 hover:bg-neutral-100 dark:hover:bg-neutral-800 text-left",children:["\uD83C\uDF10 ",(0,l.jsx)("span",{className:"ml-2",children:"Language"}),(0,l.jsx)("div",{className:"text-xs text-neutral-500 ml-7 -mt-1",children:"English"})]})]}),(0,l.jsxs)("li",{className:"grid grid-cols-2 gap-2",children:[(0,l.jsxs)("button",{className:"rounded-xl px-3 py-2 hover:bg-neutral-100 dark:hover:bg-neutral-800 text-left",children:["⚙️ ",(0,l.jsx)("span",{className:"ml-2",children:"More settings"})]}),(0,l.jsxs)("button",{className:"rounded-xl px-3 py-2 hover:bg-neutral-100 dark:hover:bg-neutral-800 text-left",children:["❔ ",(0,l.jsx)("span",{className:"ml-2",children:"Help"})]})]})]})}),(0,l.jsxs)("div",{className:"px-4 py-3 flex items-center justify-between text-xs text-neutral-600 dark:text-neutral-400 border-t border-neutral-200/70 dark:border-white/10",children:[(0,l.jsx)("div",{children:"Privacy Policy"}),(0,l.jsx)("div",{children:"Terms of Service"})]})]})]})}function c(){let{token:e,active_school_id:t,logout:a}=(0,n.a)(),[r,c]=(0,s.useState)(!1),[d,u]=(0,s.useState)(!1),x=(0,s.useRef)(null),h=(0,s.useMemo)(()=>(function(e){if(!e)return null;try{var t;let a=null===(t=e.split(".")[1])||void 0===t?void 0:t.replace(/-/g,"+").replace(/_/g,"/"),l=atob(a);return JSON.parse(l)}catch(e){return null}})(e||void 0),[e]),m=null==h?void 0:h.full_name,b=null==h?void 0:h.email,p=m||b||"Guest",v=function(e,t){var a;let l=(e||"").trim();return l?l.split(/\s+/).slice(0,2).map(e=>{var t;return(null===(t=e[0])||void 0===t?void 0:t.toUpperCase())||""}).join("")||"U":t&&(null===(a=t[0])||void 0===a?void 0:a.toUpperCase())||"U"}(m,b),g=null!=t?t:null==h?void 0:h.active_school_id;return(0,s.useEffect)(()=>{function e(e){x.current&&!x.current.contains(e.target)&&u(!1)}return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[]),(0,l.jsxs)("header",{className:"flex items-center justify-end px-4 py-3",children:[(0,l.jsx)("div",{className:"flex-1"}),e?(0,l.jsxs)("div",{className:"relative",ref:x,children:[(0,l.jsx)("button",{onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),onClick:()=>c(!0),className:"inline-flex h-10 w-10 items-center justify-center  rounded-full bg-[--color-brand] text-white font-semibold text-sm shadow-lg hover:shadow-xl ring-2 ring-[--color-brand]/30 dark:ring-[--color-brand]/40 border-2 border-[--color-brand-light]/50 hover:scale-105 active:scale-95 transition-all duration-200 ease-out","aria-label":"User menu",title:p,children:v}),d&&(0,l.jsxs)("div",{className:"absolute right-0 mt-2 card px-3 py-2 text-xs min-w-[200px] z-50",onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),children:[(0,l.jsx)("div",{className:"font-medium truncate",children:p}),b&&(0,l.jsx)("div",{className:"text-neutral-600 dark:text-neutral-400 truncate",children:b})]}),(0,l.jsx)(o,{open:r,onClose:()=>c(!1),onLogout:a,userLabel:p,email:b||void 0,schoolId:g})]}):(0,l.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[(0,l.jsx)(i.default,{className:"link-subtle",href:"/login",children:"Login"}),(0,l.jsx)(i.default,{className:"link-subtle",href:"/signup",children:"Sign up"})]})]})}var d=a(2191);function u(){let{isAuthenticated:e}=(0,d.x)(),t=(0,r.useRouter)(),[a,n]=(0,s.useState)(!1),[i,o]=(0,s.useState)(""),u=(0,s.useRef)(null),x=async e=>{let l=(null!=e?e:i).trim();if(l&&!a){n(!0);try{sessionStorage.setItem("chat-new-initial",l),t.push("/chat/new")}catch(e){console.error("Failed to create chat:",e)}finally{n(!1)}}},h=e=>{var t;o(e),null===(t=u.current)||void 0===t||t.focus()},m=e=>{let{label:t,prompt:s}=e;return(0,l.jsx)("button",{onClick:()=>h(s),className:"rounded-xl bg-neutral-200/70 px-4 py-2 text-sm dark:bg-neutral-800/80 hover:bg-neutral-200 dark:hover:bg-neutral-700 transition disabled:opacity-60",disabled:a,children:t})};return e?(0,l.jsxs)("div",{className:"min-h-[calc(100vh-0px)] grid grid-rows-[auto_1fr_auto]",children:[(0,l.jsx)(c,{}),(0,l.jsx)("main",{className:"grid place-items-center",children:(0,l.jsxs)("div",{className:"w-full max-w-3xl px-4",children:[(0,l.jsx)("div",{className:"text-center select-none mb-6",children:(0,l.jsxs)("div",{className:"text-[52px] sm:text-[64px] font-semibold tracking-tight",children:[(0,l.jsx)("span",{className:"text-neutral-900 dark:text-neutral-100",children:"School"})," ",(0,l.jsx)("span",{style:{color:"var(--color-brand)"},children:"Chat"})]})}),(0,l.jsxs)("div",{className:"mx-auto max-w-2xl",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 rounded-full border border-neutral-300/70 dark:border-white/10 bg-white/80 dark:bg-neutral-900/70 px-4 py-3 shadow-[var(--shadow-soft)]",children:[(0,l.jsx)("span",{className:"text-neutral-500",children:"⌕"}),(0,l.jsx)("input",{ref:u,value:i,onChange:e=>o(e.target.value),onKeyDown:e=>{"Enter"===e.key&&x()},placeholder:"Ask your school… e.g., create class P4 East",className:"w-full bg-transparent outline-none text-sm sm:text-base",disabled:a,"aria-label":"Search or chat"}),(0,l.jsx)("button",{onClick:()=>x(),className:"rounded-full px-4 py-2 text-sm text-white bg-[--color-brand] hover:bg-[--color-brand-dark] transition disabled:opacity-60",disabled:a||!i.trim(),children:a?"…":"Search"})]}),(0,l.jsxs)("div",{className:"mt-6 flex items-center justify-center gap-3",children:[(0,l.jsx)("button",{onClick:()=>h("help me get started with school management"),className:"rounded-xl bg-neutral-200/70 px-4 py-2 text-sm dark:bg-neutral-800/80 hover:bg-neutral-200 dark:hover:bg-neutral-700 transition disabled:opacity-60",disabled:a,children:"School Chat Search"}),(0,l.jsx)("button",{onClick:()=>h("help"),className:"rounded-xl bg-neutral-200/70 px-4 py-2 text-sm dark:bg-neutral-800/80 hover:bg-neutral-200 dark:hover:bg-neutral-700 transition disabled:opacity-60",disabled:a,children:"I'm Feeling Curious"})]}),(0,l.jsxs)("div",{className:"mt-5 flex flex-wrap items-center justify-center gap-2",children:[(0,l.jsx)(m,{label:"Create Class",prompt:"create class P4 East"}),(0,l.jsx)(m,{label:"List Students",prompt:"list students"}),(0,l.jsx)(m,{label:"Enroll Student",prompt:"enroll student John Doe admission 123 into P4 East"}),(0,l.jsx)(m,{label:"Create Invoice",prompt:"create invoice for student 123 amount 15000"}),(0,l.jsx)(m,{label:"Record Payment",prompt:"record payment invoice 1 amount 15000"})]})]})]})}),(0,l.jsx)("footer",{className:"text-xs text-neutral-600 dark:text-neutral-400 border-t border-neutral-200/70 dark:border-white/10",children:(0,l.jsxs)("div",{className:"mx-auto max-w-6xl px-4 py-3 flex flex-col sm:flex-row gap-2 sm:gap-0 sm:items-center sm:justify-between",children:[(0,l.jsx)("div",{children:"Kenya"}),(0,l.jsxs)("div",{className:"flex gap-4",children:[(0,l.jsx)("a",{className:"link-subtle",href:"#",children:"Privacy"}),(0,l.jsx)("a",{className:"link-subtle",href:"#",children:"Terms"}),(0,l.jsx)("a",{className:"link-subtle",href:"#",children:"About"})]})]})})]}):null}},857:function(e,t,a){"use strict";a.d(t,{AuthProvider:function(){return i},a:function(){return o}});var l=a(7437),s=a(2265),r=a(6463);let n=(0,s.createContext)({token:null,active_school_id:null,isLoading:!0,login:async()=>{},logout:()=>{},setSchoolId:()=>{},isAuthenticated:!1});function i(e){let{children:t}=e,[a,i]=(0,s.useState)({token:null,active_school_id:null,isLoading:!0}),o=(0,r.useRouter)();(0,s.useEffect)(()=>{i({token:localStorage.getItem("token"),active_school_id:localStorage.getItem("active_school_id"),isLoading:!1})},[]);let c=async e=>{localStorage.setItem("token",e.token),i(t=>({...t,token:e.token,isLoading:!1}))},d={...a,login:c,logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("active_school_id"),i({token:null,active_school_id:null,isLoading:!1}),o.replace("/login")},setSchoolId:e=>{localStorage.setItem("active_school_id",e),i(t=>({...t,active_school_id:e}))},isAuthenticated:!!a.token&&!a.isLoading};return(0,l.jsx)(n.Provider,{value:d,children:t})}let o=()=>(0,s.useContext)(n)},2191:function(e,t,a){"use strict";a.d(t,{x:function(){return n}});var l=a(2265),s=a(6463),r=a(857);function n(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/login",{token:t,isLoading:a}=(0,r.a)(),n=(0,s.useRouter)();return(0,l.useEffect)(()=>{if(!a&&!t){let t=window.location.pathname+window.location.search,a="".concat(e,"?next=").concat(encodeURIComponent(t));n.replace(a)}},[t,a,n,e]),{isAuthenticated:!!t&&!a,isLoading:a}}},6463:function(e,t,a){"use strict";var l=a(1169);a.o(l,"useParams")&&a.d(t,{useParams:function(){return l.useParams}}),a.o(l,"usePathname")&&a.d(t,{usePathname:function(){return l.usePathname}}),a.o(l,"useRouter")&&a.d(t,{useRouter:function(){return l.useRouter}}),a.o(l,"useSearchParams")&&a.d(t,{useSearchParams:function(){return l.useSearchParams}})}},function(e){e.O(0,[138,971,23,744],function(){return e(e.s=2455)}),_N_E=e.O()}]);